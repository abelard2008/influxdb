!function(t,e){"object"==typeof exports&&"undefined"!=typeof module?e(exports,require("react"),require("react-dom")):"function"==typeof define&&define.amd?define(["exports","react","react-dom"],e):e((t=t||self)["@influxdata/vis"]={},t.React,t.ReactDOM)}(this,function(t,e,n){"use strict";var r=function(){return(r=Object.assign||function(t){for(var e,n=1,r=arguments.length;n<r;n++)for(var i in e=arguments[n])Object.prototype.hasOwnProperty.call(e,i)&&(t[i]=e[i]);return t}).apply(this,arguments)};function i(t){var e="function"==typeof Symbol&&t[Symbol.iterator],n=0;return e?e.call(t):{next:function(){return t&&n>=t.length&&(t=void 0),{value:t&&t[n++],done:!t}}}}function o(t,e){var n="function"==typeof Symbol&&t[Symbol.iterator];if(!n)return t;var r,i,o=n.call(t),a=[];try{for(;(void 0===e||e-- >0)&&!(r=o.next()).done;)a.push(r.value)}catch(t){i={error:t}}finally{try{r&&!r.done&&(n=o.return)&&n.call(o)}finally{if(i)throw i.error}}return a}function a(){for(var t=[],e=0;e<arguments.length;e++)t=t.concat(o(arguments[e]));return t}function u(t){var e;e="undefined"!=typeof window?window:"undefined"!=typeof self?self:global;var n,r,i="undefined"!=typeof document&&document.attachEvent;if(!i){var o=(r=e.requestAnimationFrame||e.mozRequestAnimationFrame||e.webkitRequestAnimationFrame||function(t){return e.setTimeout(t,20)},function(t){return r(t)}),a=(n=e.cancelAnimationFrame||e.mozCancelAnimationFrame||e.webkitCancelAnimationFrame||e.clearTimeout,function(t){return n(t)}),u=function(t){var e=t.__resizeTriggers__,n=e.firstElementChild,r=e.lastElementChild,i=n.firstElementChild;r.scrollLeft=r.scrollWidth,r.scrollTop=r.scrollHeight,i.style.width=n.offsetWidth+1+"px",i.style.height=n.offsetHeight+1+"px",n.scrollLeft=n.scrollWidth,n.scrollTop=n.scrollHeight},l=function(t){if(!(t.target.className.indexOf("contract-trigger")<0&&t.target.className.indexOf("expand-trigger")<0)){var e=this;u(this),this.__resizeRAF__&&a(this.__resizeRAF__),this.__resizeRAF__=o(function(){(function(t){return t.offsetWidth!=t.__resizeLast__.width||t.offsetHeight!=t.__resizeLast__.height})(e)&&(e.__resizeLast__.width=e.offsetWidth,e.__resizeLast__.height=e.offsetHeight,e.__resizeListeners__.forEach(function(n){n.call(e,t)}))})}},c=!1,s="",f="animationstart",h="Webkit Moz O ms".split(" "),g="webkitAnimationStart animationstart oAnimationStart MSAnimationStart".split(" "),m=document.createElement("fakeelement");if(void 0!==m.style.animationName&&(c=!0),!1===c)for(var d=0;d<h.length;d++)if(void 0!==m.style[h[d]+"AnimationName"]){s="-"+h[d].toLowerCase()+"-",f=g[d],c=!0;break}var y="resizeanim",p="@"+s+"keyframes "+y+" { from { opacity: 0; } to { opacity: 0; } } ",v=s+"animation: 1ms "+y+"; "}return{addResizeListener:function(n,r){if(i)n.attachEvent("onresize",r);else{if(!n.__resizeTriggers__){var o=n.ownerDocument,a=e.getComputedStyle(n);a&&"static"==a.position&&(n.style.position="relative"),function(e){if(!e.getElementById("detectElementResize")){var n=(p||"")+".resize-triggers { "+(v||"")+'visibility: hidden; opacity: 0; } .resize-triggers, .resize-triggers > div, .contract-trigger:before { content: " "; display: block; position: absolute; top: 0; left: 0; height: 100%; width: 100%; overflow: hidden; z-index: -1; } .resize-triggers > div { background: #eee; overflow: auto; } .contract-trigger:before { width: 200%; height: 200%; }',r=e.head||e.getElementsByTagName("head")[0],i=e.createElement("style");i.id="detectElementResize",i.type="text/css",null!=t&&i.setAttribute("nonce",t),i.styleSheet?i.styleSheet.cssText=n:i.appendChild(e.createTextNode(n)),r.appendChild(i)}}(o),n.__resizeLast__={},n.__resizeListeners__=[],(n.__resizeTriggers__=o.createElement("div")).className="resize-triggers",n.__resizeTriggers__.innerHTML='<div class="expand-trigger"><div></div></div><div class="contract-trigger"></div>',n.appendChild(n.__resizeTriggers__),u(n),n.addEventListener("scroll",l,!0),f&&(n.__resizeTriggers__.__animationListener__=function(t){t.animationName==y&&u(n)},n.__resizeTriggers__.addEventListener(f,n.__resizeTriggers__.__animationListener__))}n.__resizeListeners__.push(r)}},removeResizeListener:function(t,e){if(i)t.detachEvent("onresize",e);else if(t.__resizeListeners__.splice(t.__resizeListeners__.indexOf(e),1),!t.__resizeListeners__.length){t.removeEventListener("scroll",l,!0),t.__resizeTriggers__.__animationListener__&&(t.__resizeTriggers__.removeEventListener(f,t.__resizeTriggers__.__animationListener__),t.__resizeTriggers__.__animationListener__=null);try{t.__resizeTriggers__=!t.removeChild(t.__resizeTriggers__)}catch(t){}}}}}var l=function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")},c=function(){function t(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}return function(e,n,r){return n&&t(e.prototype,n),r&&t(e,r),e}}(),s=Object.assign||function(t){for(var e=1;e<arguments.length;e++){var n=arguments[e];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(t[r]=n[r])}return t},f=function(t,e){if(!t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!e||"object"!=typeof e&&"function"!=typeof e?t:e},h=function(t){function n(){var t,e,r;l(this,n);for(var i=arguments.length,o=Array(i),a=0;a<i;a++)o[a]=arguments[a];return e=r=f(this,(t=n.__proto__||Object.getPrototypeOf(n)).call.apply(t,[this].concat(o))),r.state={height:r.props.defaultHeight||0,width:r.props.defaultWidth||0},r._onResize=function(){var t=r.props,e=t.disableHeight,n=t.disableWidth,i=t.onResize;if(r._parentNode){var o=r._parentNode.offsetHeight||0,a=r._parentNode.offsetWidth||0,u=window.getComputedStyle(r._parentNode)||{},l=parseInt(u.paddingLeft,10)||0,c=parseInt(u.paddingRight,10)||0,s=parseInt(u.paddingTop,10)||0,f=parseInt(u.paddingBottom,10)||0,h=o-s-f,g=a-l-c;(!e&&r.state.height!==h||!n&&r.state.width!==g)&&(r.setState({height:o-s-f,width:a-l-c}),i({height:o,width:a}))}},r._setRef=function(t){r._autoSizer=t},f(r,e)}return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+typeof e);t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}(n,e.PureComponent),c(n,[{key:"componentDidMount",value:function(){var t=this.props.nonce;this._autoSizer&&this._autoSizer.parentNode&&this._autoSizer.parentNode.ownerDocument&&this._autoSizer.parentNode.ownerDocument.defaultView&&this._autoSizer.parentNode instanceof this._autoSizer.parentNode.ownerDocument.defaultView.HTMLElement&&(this._parentNode=this._autoSizer.parentNode,this._detectElementResize=u(t),this._detectElementResize.addResizeListener(this._parentNode,this._onResize),this._onResize())}},{key:"componentWillUnmount",value:function(){this._detectElementResize&&this._parentNode&&this._detectElementResize.removeResizeListener(this._parentNode,this._onResize)}},{key:"render",value:function(){var t=this.props,n=t.children,r=t.className,i=t.disableHeight,o=t.disableWidth,a=t.style,u=this.state,l=u.height,c=u.width,f={overflow:"visible"},h={},g=!1;return i||(0===l&&(g=!0),f.height=0,h.height=l),o||(0===c&&(g=!0),f.width=0,h.width=c),e.createElement("div",{className:r,ref:this._setRef,style:s({},f,a)},!g&&n(h))}}]),n}();h.defaultProps={onResize:function(){},disableHeight:!1,disableWidth:!1,style:{}};var g=Math.PI,m=2*g,d=m-1e-6;function y(){this._x0=this._y0=this._x1=this._y1=null,this._=""}function p(){return new y}function v(t){return function(){return t}}y.prototype=p.prototype={constructor:y,moveTo:function(t,e){this._+="M"+(this._x0=this._x1=+t)+","+(this._y0=this._y1=+e)},closePath:function(){null!==this._x1&&(this._x1=this._x0,this._y1=this._y0,this._+="Z")},lineTo:function(t,e){this._+="L"+(this._x1=+t)+","+(this._y1=+e)},quadraticCurveTo:function(t,e,n,r){this._+="Q"+ +t+","+ +e+","+(this._x1=+n)+","+(this._y1=+r)},bezierCurveTo:function(t,e,n,r,i,o){this._+="C"+ +t+","+ +e+","+ +n+","+ +r+","+(this._x1=+i)+","+(this._y1=+o)},arcTo:function(t,e,n,r,i){t=+t,e=+e,n=+n,r=+r,i=+i;var o=this._x1,a=this._y1,u=n-t,l=r-e,c=o-t,s=a-e,f=c*c+s*s;if(i<0)throw new Error("negative radius: "+i);if(null===this._x1)this._+="M"+(this._x1=t)+","+(this._y1=e);else if(f>1e-6)if(Math.abs(s*u-l*c)>1e-6&&i){var h=n-o,m=r-a,d=u*u+l*l,y=h*h+m*m,p=Math.sqrt(d),v=Math.sqrt(f),x=i*Math.tan((g-Math.acos((d+f-y)/(2*p*v)))/2),b=x/v,_=x/p;Math.abs(b-1)>1e-6&&(this._+="L"+(t+b*c)+","+(e+b*s)),this._+="A"+i+","+i+",0,0,"+ +(s*h>c*m)+","+(this._x1=t+_*u)+","+(this._y1=e+_*l)}else this._+="L"+(this._x1=t)+","+(this._y1=e);else;},arc:function(t,e,n,r,i,o){t=+t,e=+e;var a=(n=+n)*Math.cos(r),u=n*Math.sin(r),l=t+a,c=e+u,s=1^o,f=o?r-i:i-r;if(n<0)throw new Error("negative radius: "+n);null===this._x1?this._+="M"+l+","+c:(Math.abs(this._x1-l)>1e-6||Math.abs(this._y1-c)>1e-6)&&(this._+="L"+l+","+c),n&&(f<0&&(f=f%m+m),f>d?this._+="A"+n+","+n+",0,1,"+s+","+(t-a)+","+(e-u)+"A"+n+","+n+",0,1,"+s+","+(this._x1=l)+","+(this._y1=c):f>1e-6&&(this._+="A"+n+","+n+",0,"+ +(f>=g)+","+s+","+(this._x1=t+n*Math.cos(i))+","+(this._y1=e+n*Math.sin(i))))},rect:function(t,e,n,r){this._+="M"+(this._x0=this._x1=+t)+","+(this._y0=this._y1=+e)+"h"+ +n+"v"+ +r+"h"+-n+"Z"},toString:function(){return this._}};Math.PI;function x(t){this._context=t}function b(t){return new x(t)}function _(t){return t[0]}function M(t){return t[1]}function w(t,e,n){t._context.bezierCurveTo((2*t._x0+t._x1)/3,(2*t._y0+t._y1)/3,(t._x0+2*t._x1)/3,(t._y0+2*t._y1)/3,(t._x0+4*t._x1+e)/6,(t._y0+4*t._y1+n)/6)}function C(t){this._context=t}function T(t){return t<0?-1:1}function k(t,e,n){var r=t._x1-t._x0,i=e-t._x1,o=(t._y1-t._y0)/(r||i<0&&-0),a=(n-t._y1)/(i||r<0&&-0),u=(o*i+a*r)/(r+i);return(T(o)+T(a))*Math.min(Math.abs(o),Math.abs(a),.5*Math.abs(u))||0}function S(t,e){var n=t._x1-t._x0;return n?(3*(t._y1-t._y0)/n-e)/2:e}function N(t,e,n){var r=t._x0,i=t._y0,o=t._x1,a=t._y1,u=(o-r)/3;t._context.bezierCurveTo(r+u,i+u*e,o-u,a-u*n,o,a)}function F(t){this._context=t}function D(t){this._context=new E(t)}function E(t){this._context=t}function A(t){this._context=t}function L(t){var e,n,r=t.length-1,i=new Array(r),o=new Array(r),a=new Array(r);for(i[0]=0,o[0]=2,a[0]=t[0]+2*t[1],e=1;e<r-1;++e)i[e]=1,o[e]=4,a[e]=4*t[e]+2*t[e+1];for(i[r-1]=2,o[r-1]=7,a[r-1]=8*t[r-1]+t[r],e=1;e<r;++e)n=i[e]/o[e-1],o[e]-=n,a[e]-=n*a[e-1];for(i[r-1]=a[r-1]/o[r-1],e=r-2;e>=0;--e)i[e]=(a[e]-i[e+1])/o[e];for(o[r-1]=(t[r]+i[r-1])/2,e=0;e<r-1;++e)o[e]=2*t[e+1]-i[e+1];return[i,o]}function z(t,e){this._context=t,this._t=e}x.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._point=0},lineEnd:function(){(this._line||0!==this._line&&1===this._point)&&this._context.closePath(),this._line=1-this._line},point:function(t,e){switch(t=+t,e=+e,this._point){case 0:this._point=1,this._line?this._context.lineTo(t,e):this._context.moveTo(t,e);break;case 1:this._point=2;default:this._context.lineTo(t,e)}}},C.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._x0=this._x1=this._y0=this._y1=NaN,this._point=0},lineEnd:function(){switch(this._point){case 3:w(this,this._x1,this._y1);case 2:this._context.lineTo(this._x1,this._y1)}(this._line||0!==this._line&&1===this._point)&&this._context.closePath(),this._line=1-this._line},point:function(t,e){switch(t=+t,e=+e,this._point){case 0:this._point=1,this._line?this._context.lineTo(t,e):this._context.moveTo(t,e);break;case 1:this._point=2;break;case 2:this._point=3,this._context.lineTo((5*this._x0+this._x1)/6,(5*this._y0+this._y1)/6);default:w(this,t,e)}this._x0=this._x1,this._x1=t,this._y0=this._y1,this._y1=e}},F.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._x0=this._x1=this._y0=this._y1=this._t0=NaN,this._point=0},lineEnd:function(){switch(this._point){case 2:this._context.lineTo(this._x1,this._y1);break;case 3:N(this,this._t0,S(this,this._t0))}(this._line||0!==this._line&&1===this._point)&&this._context.closePath(),this._line=1-this._line},point:function(t,e){var n=NaN;if(e=+e,(t=+t)!==this._x1||e!==this._y1){switch(this._point){case 0:this._point=1,this._line?this._context.lineTo(t,e):this._context.moveTo(t,e);break;case 1:this._point=2;break;case 2:this._point=3,N(this,S(this,n=k(this,t,e)),n);break;default:N(this,this._t0,n=k(this,t,e))}this._x0=this._x1,this._x1=t,this._y0=this._y1,this._y1=e,this._t0=n}}},(D.prototype=Object.create(F.prototype)).point=function(t,e){F.prototype.point.call(this,e,t)},E.prototype={moveTo:function(t,e){this._context.moveTo(e,t)},closePath:function(){this._context.closePath()},lineTo:function(t,e){this._context.lineTo(e,t)},bezierCurveTo:function(t,e,n,r,i,o){this._context.bezierCurveTo(e,t,r,n,o,i)}},A.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._x=[],this._y=[]},lineEnd:function(){var t=this._x,e=this._y,n=t.length;if(n)if(this._line?this._context.lineTo(t[0],e[0]):this._context.moveTo(t[0],e[0]),2===n)this._context.lineTo(t[1],e[1]);else for(var r=L(t),i=L(e),o=0,a=1;a<n;++o,++a)this._context.bezierCurveTo(r[0][o],i[0][o],r[1][o],i[1][o],t[a],e[a]);(this._line||0!==this._line&&1===n)&&this._context.closePath(),this._line=1-this._line,this._x=this._y=null},point:function(t,e){this._x.push(+t),this._y.push(+e)}},z.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._x=this._y=NaN,this._point=0},lineEnd:function(){0<this._t&&this._t<1&&2===this._point&&this._context.lineTo(this._x,this._y),(this._line||0!==this._line&&1===this._point)&&this._context.closePath(),this._line>=0&&(this._t=1-this._t,this._line=1-this._line)},point:function(t,e){switch(t=+t,e=+e,this._point){case 0:this._point=1,this._line?this._context.lineTo(t,e):this._context.moveTo(t,e);break;case 1:this._point=2;default:if(this._t<=0)this._context.lineTo(this._x,e),this._context.lineTo(t,e);else{var n=this._x*(1-this._t)+t*this._t;this._context.lineTo(n,this._y),this._context.lineTo(n,e)}}this._x=t,this._y=e}};var U=["#31C0F6","#A500A5","#FF7E27"],P={linear:b,monotoneX:function(t){return new F(t)},monotoneY:function(t){return new D(t)},cubic:function(t){return new C(t)},step:function(t){return new z(t,.5)},stepBefore:function(t){return new z(t,0)},stepAfter:function(t){return new z(t,1)},natural:function(t){return new A(t)}},R={layers:[],valueFormatters:{},xAxisLabel:"",yAxisLabel:"",showAxes:!0,axisColor:"#292933",axisOpacity:1,gridColor:"#292933",gridOpacity:1,tickFont:"10px sans-serif",tickFontColor:"#8e91a1",legendFont:"10px monospace",legendFontColor:"#8e91a1",legendFontBrightColor:"#c6cad3",legendBackgroundColor:"#1c1c21",legendBorder:"1px solid #202028",legendCrosshairColor:"#31313d"},O={line:{lineWidth:1,hoverDimension:"auto",fill:[],colors:U,interpolation:"linear",maxTooltipRows:24},heatmap:{colors:U,binSize:10},scatter:{colors:U,fill:[],symbol:[]},histogram:{fill:[],colors:U,position:"stacked",binCount:null}},j=function(t,e,n){var r=t.getContext("2d"),i=window.devicePixelRatio||1;t.width=e*i,t.height=n*i,t.style.width=e+"px",t.style.height=n+"px",r.scale(i,i),r.clearRect(0,0,e,n)},Y=function(t){var n=t.env,r=t.style,o=e.useRef(null),a=n.innerWidth,u=n.innerHeight,l=n.margins,c=n.xTicks,s=n.yTicks,f=n.xTickFormatter,h=n.yTickFormatter,g=n.xScale,m=n.yScale,d=n.config;return e.useLayoutEffect(function(){!function(t){var e,n,r,o,a=t.canvas,u=t.innerWidth,l=t.innerHeight,c=t.margins,s=t.xTicks,f=t.yTicks,h=t.xTickFormatter,g=t.yTickFormatter,m=t.xScale,d=t.yScale,y=t.config,p=y.width,v=y.height,x=y.axisColor,b=y.axisOpacity,_=y.gridColor,M=y.gridOpacity,w=y.tickFont,C=y.tickFontColor,T=y.xAxisLabel,k=y.yAxisLabel;j(a,p,v);var S=a.getContext("2d"),N=v-c.bottom;S.font=w,S.textAlign="center",S.textBaseline="top";try{for(var F=i(s),D=F.next();!D.done;D=F.next()){var E=D.value,A=m(E)+c.left;Math.abs(A-c.left)>5&&Math.abs(A-(p-c.right))>5&&(S.strokeStyle=_,S.globalAlpha=M,S.beginPath(),S.moveTo(A,N),S.lineTo(A,c.top),S.stroke()),S.globalAlpha=1,S.fillStyle=C,S.fillText(h(E),A,N+8)}}catch(t){e={error:t}}finally{try{D&&!D.done&&(n=F.return)&&n.call(F)}finally{if(e)throw e.error}}S.textAlign="end",S.textBaseline="middle";try{for(var L=i(f),z=L.next();!z.done;z=L.next()){var U=z.value,P=d(U)+c.top;Math.abs(P-c.top)>5&&Math.abs(P-(v-c.bottom))>5&&(S.strokeStyle=_,S.globalAlpha=M,S.beginPath(),S.moveTo(c.left,P),S.lineTo(p-c.right,P),S.stroke()),S.globalAlpha=1,S.fillStyle=C,S.fillText(g(U),c.left-8,P)}}catch(t){r={error:t}}finally{try{z&&!z.done&&(o=L.return)&&o.call(L)}finally{if(r)throw r.error}}S.globalAlpha=b,S.strokeStyle=x,S.beginPath(),S.moveTo(c.left,N),S.lineTo(p-c.right,N),S.stroke(),S.beginPath(),S.moveTo(c.left,c.top),S.lineTo(p-c.right,c.top),S.stroke(),S.beginPath(),S.moveTo(c.left,N),S.lineTo(c.left,c.top),S.stroke(),S.beginPath(),S.moveTo(p-c.right,N),S.lineTo(p-c.right,c.top),S.stroke(),S.globalAlpha=1,T&&(S.textAlign="center",S.textBaseline="bottom",S.fillText(T,c.left+u/2,v)),k&&(A=0,P=c.top+l/2,S.save(),S.translate(A,P),S.rotate(-Math.PI/2),S.textAlign="center",S.textBaseline="top",S.fillText(k,0,0),S.restore())}({canvas:o.current,innerWidth:a,innerHeight:u,margins:l,xTicks:c,yTicks:s,xTickFormatter:f,yTickFormatter:h,xScale:g,yScale:m,config:d})},[o.current,a,u,l,c,s,f,h,g,m,d]),e.createElement("canvas",{className:"vis-axes",ref:o,style:r})};function H(t,e){return t<e?-1:t>e?1:t>=e?0:NaN}var W,I;1===(W=H).length&&(I=W,W=function(t,e){return H(I(t),e)});function B(t,e){let n,r;if(void 0===e)for(let e of t)null!=e&&e>=e&&(void 0===n?n=r=e:(n>e&&(n=e),r<e&&(r=e)));else{let i=-1;for(let o of t)null!=(o=e(o,++i,t))&&o>=o&&(void 0===n?n=r=o:(n>o&&(n=o),r<o&&(r=o)))}return[n,r]}function X(t,e,n){t=+t,e=+e,n=(i=arguments.length)<2?(e=t,t=0,1):i<3?1:+n;for(var r=-1,i=0|Math.max(0,Math.ceil((e-t)/n)),o=new Array(i);++r<i;)o[r]=t+r*n;return o}var q=Math.sqrt(50),$=Math.sqrt(10),Z=Math.sqrt(2);function K(t,e,n){var r,i,o,a,u=-1;if(n=+n,(t=+t)===(e=+e)&&n>0)return[t];if((r=e<t)&&(i=t,t=e,e=i),0===(a=function(t,e,n){var r=(e-t)/Math.max(0,n),i=Math.floor(Math.log(r)/Math.LN10),o=r/Math.pow(10,i);return i>=0?(o>=q?10:o>=$?5:o>=Z?2:1)*Math.pow(10,i):-Math.pow(10,-i)/(o>=q?10:o>=$?5:o>=Z?2:1)}(t,e,n))||!isFinite(a))return[];if(a>0)for(t=Math.ceil(t/a),e=Math.floor(e/a),o=new Array(i=Math.ceil(e-t+1));++u<i;)o[u]=(t+u)*a;else for(t=Math.floor(t*a),e=Math.ceil(e*a),o=new Array(i=Math.ceil(t-e+1));++u<i;)o[u]=(t-u)/a;return r&&o.reverse(),o}var V=function(t){return null==t},Q=function(t,e,n){return V(t)||V(e)?"":t===e?n(t):n(t)+" – "+n(e)},J=function(t,e,n,r,i){return n.map(function(n){var o=t.getColumn(n),a=r(n);return{key:n,name:t.getColumnName(n),type:t.getColumnType(n),colors:i,values:e.map(function(t){return a(o[t])})}})},G="__fill",tt=function(t){var e=t.currentTarget.getBoundingClientRect(),n=e.top,r=e.left;return{x:t.pageX-r,y:t.pageY-n}},et=function(t){var n=function(t){var n=o(e.useState({x:null,y:null}),2),r=n[0],i=n[1];return e.useEffect(function(){if(t){var e=function(e){var n=t.getBoundingClientRect(),r=n.left,o=n.top;i({x:e.pageX-r,y:e.pageY-o})},n=function(t){e(t)},r=function(){i({x:null,y:null})};return t.addEventListener("mouseenter",e),t.addEventListener("mousemove",n),t.addEventListener("mouseleave",r),function(){t.removeEventListener("mouseenter",e),t.removeEventListener("mousemove",n),t.removeEventListener("mouseleave",r)}}i({x:null,y:null})},[t]),r}(document.body),r=n.x,a=n.y;!function(t,n){e.useLayoutEffect(function(){var e,r;if(t){var a=n(t);try{for(var u=i(Object.entries(a)),l=u.next();!l.done;l=u.next()){var c=o(l.value,2),s=c[0],f=c[1];t.style[s]=f}}catch(t){e={error:t}}finally{try{l&&!l.done&&(r=u.return)&&r.call(u)}finally{if(e)throw e.error}}}})}(t,function(t){var e=t.offsetWidth,n=t.offsetHeight;if(null===r||null===a)return{display:"none"};var i=30,o=0-n/2;return r+i+e>window.innerWidth&&(i=-30-e),a+o+n>window.innerHeight&&(o-=a+o+n-window.innerHeight),a+o<0&&(o+=0-(a+o)),{display:"inline",position:"fixed",left:r+i+"px",top:a+o+"px"}})},nt=function(t){var r,i=t.data,o=t.env,a=(null===(r=e.useRef(null)).current&&(r.current=document.createElement("div"),r.current.classList.add("vis-tooltip-container"),document.body.appendChild(r.current)),e.useEffect(function(){return function(){return document.body.removeChild(r.current)}},[]),et(r.current),r.current),u=o.config,l=u.legendFont,c=u.legendFontColor,s=u.legendFontBrightColor,f=u.legendBackgroundColor,h=u.legendBorder,g=u.legendColumns,m=g?i.filter(function(t){return g.includes(t.key)}):i;return n.createPortal(e.createElement("div",{className:"vis-tooltip",style:{border:h,font:l,backgroundColor:f,color:s,borderRadius:"3px",padding:"10px",cursor:"crosshair"}},e.createElement("div",{className:"vis-tooltip-table",style:{display:"flex",justifyContent:"space-between"}},m.map(function(t,n){var r=t.name,o=t.type,a=t.values,u=t.colors;return e.createElement("div",{key:r,className:"vis-tooltip-column",style:{marginRight:n===i.length-1?0:"15px",textAlign:"number"===o?"right":"left"}},e.createElement("div",{className:"vis-tooltip-column-header",style:{marginBottom:"5px",color:c}},r),a.map(function(t,n){return e.createElement("div",{className:"vis-tooltip-column-value",key:n,style:{color:u&&u[n]?u[n]:s,maxWidth:"200px",overflow:"hidden",textOverflow:"ellipsis",whiteSpace:"nowrap"}},t)}))}))),a)},rt=function(t){var n=t.layerIndex,r=t.env,i=t.hoverX,o=t.hoverY,u=e.useRef(null),l=r.getTable(n),c=r.getScale(n,"fill"),s=r.config.layers[n],f=s.x,h=s.fill,g=r.xScale,m=r.yScale,d=r.innerWidth,y=r.innerHeight;e.useLayoutEffect(function(){!function(t){var e=t.canvas,n=t.table,r=t.width,i=t.height,o=t.xScale,a=t.yScale,u=t.fillScale,l=t.hoveredRowIndices;j(e,r,i);for(var c=n.getColumn("xMin","number"),s=n.getColumn("xMax","number"),f=n.getColumn("yMin","number"),h=n.getColumn("yMax","number"),g=n.getColumn(G,"string"),m=e.getContext("2d"),d=0;d<h.length;d++)if(f[d]!==h[d]){var y=o(c[d]),p=a(h[d]),v=o(s[d])-y-1.5,x=a(f[d])-p-1.5,b=u(g[d]),_=l&&l.includes(d)?.7:.5;m.beginPath(),m.rect(y,p,v,x),m.save(),m.clip(),m.lineWidth=2,m.globalAlpha=_,m.fillStyle=b,m.fill(),m.globalAlpha=1,m.strokeStyle=b,m.stroke(),m.restore()}}({table:l,fillScale:c,canvas:u.current,width:d,height:y,xScale:g,yScale:m,hoveredRowIndices:p})});var p=function(t,e,n,r,i){if(!e||!n)return null;var o=t.getColumn("xMin","number"),a=t.getColumn("xMax","number"),u=t.getColumn("yMax","number"),l=r.invert(e),c=i.invert(n),s=X(0,o.length).filter(function(t){return o[t]<=l&&a[t]>l});return s.some(function(t){return u[t]>=c})?s:null}(l,i,o,g,m),v=function(t,e,n,r,i,o){if(!t||0===t.length)return null;var u=e.getColumn("xMin","number"),l=e.getColumn("xMax","number"),c=e.getColumn("count","number"),s=e.getColumn(G,"string"),f=t.map(function(t){return o(s[t])}),h=i(n),g=i("yMin");return a([{key:n,name:n,type:"number",colors:f,values:t.map(function(t){return Q(u[t],l[t],h)})},{key:"count",name:"count",type:"number",colors:f,values:t.map(function(t){return g(c[t])})}],J(e,t,r,i,f))}(p,l,f,h,r.getFormatterForColumn,c);return e.createElement(e.Fragment,null,e.createElement("canvas",{className:"vis-layer histogram",ref:u}),v&&e.createElement(nt,{data:v,env:r}))},it=function(t){return null!=t&&!isNaN(t)},ot=function(t){var e,n,r=t.canvas,o=t.lineData,a=t.interpolation,u=t.lineWidth,l=void 0===u?1:u,c=r.getContext("2d");c.lineWidth=l;var s=function(t,e,n){var r=function(){var t=_,e=M,n=v(!0),r=null,i=b,o=null;function a(a){var u,l,c,s=a.length,f=!1;for(null==r&&(o=i(c=p())),u=0;u<=s;++u)!(u<s&&n(l=a[u],u,a))===f&&((f=!f)?o.lineStart():o.lineEnd()),f&&o.point(+t(l,u,a),+e(l,u,a));if(c)return o=null,c+""||null}return a.x=function(e){return arguments.length?(t="function"==typeof e?e:v(+e),a):t},a.y=function(t){return arguments.length?(e="function"==typeof t?t:v(+t),a):e},a.defined=function(t){return arguments.length?(n="function"==typeof t?t:v(!!t),a):n},a.curve=function(t){return arguments.length?(i=t,null!=r&&(o=i(r)),a):i},a.context=function(t){return arguments.length?(null==t?r=o=null:o=i(r=t),a):r},a}().context(c).x(function(e){return t[e]}).y(function(t){return e[t]}).defined(function(n){return it(t[n])&&it(e[n])}).curve(P[a]||b);c.strokeStyle=n,c.beginPath(),r(X(0,t.length)),c.stroke()};try{for(var f=i(Object.values(o)),h=f.next();!h.done;h=f.next()){var g=h.value;s(g.xs,g.ys,g.fill)}}catch(t){e={error:t}}finally{try{h&&!h.done&&(n=f.return)&&n.call(f)}finally{if(e)throw e.error}}},at=function(t,e,n,r,i,o){var a=t,u=e,l=n-t,c=r-e;if(0!==l||0!==c){var s=((i-a)*l+(o-u)*c)/(l*l+c*c);s>1?(a=n,u=r):s>0&&(a+=l*s,u+=c*s)}return(l=i-a)*l+(c=o-u)*c},ut=function(t,e,n,r,i,o){for(var a=t[r],u=e[r],l=t[i],c=e[i],s=0,f=-1,h=r+1;h<i;h++){var g=at(a,u,l,c,t[h],e[h]);g>f&&(s=h,f=g)}f>n&&(o[s]=1,s-r>1&&ut(t,e,n,r,s,o),i-s>1&&ut(t,e,n,s,i,o))},lt=function(t,e,n){var r=o(function(t,e,n){var r,i,o,a,u=Math.pow(n,2),l=new Uint8Array(t.length),c=t[0],s=e[0],f=1;l[0]=1,l[l.length-1]=1;for(var h=1;h<t.length;h++){var g=t[h],m=e[h];r=g,i=m,o=c,a=s,Math.pow(a-i,2)+Math.pow(o-r,2)>u&&(l[h]=1,c=g,s=m,f++)}for(var d=new Float64Array(f),y=new Float64Array(f),p=0,v=0;v<l.length;v++)1===l[v]&&(d[p]=t[v],y[p]=e[v],p++);return[d,y]}(t,e,n),2),i=o(function(t,e,n){var r=new Uint8Array(t.length),i=n*n;r[0]=1,r[r.length-1]=1,ut(t,e,i,0,r.length-1,r);for(var o=0,a=0;a<r.length;a++)1===r[a]&&o++;var u=new Float64Array(o),l=new Float64Array(o),c=0;for(a=0;a<r.length;a++)1===r[a]&&(u[c]=t[a],l[c]=e[a],c++);return[u,l]}(r[0],r[1],n),2);return[i[0],i[1]]},ct=function(t){var n=t.env,r=t.layerIndex,o=t.lineData,u=t.rowIndices,l=t.dimension,c=n.getTable(r),s=n.getScale(r,"fill"),f=n.config.layers[r],h=f.interpolation,g=f.x,m=f.y,d=f.fill,y=f.lineWidth,p=n.xScale,v=n.yScale,x=n.innerWidth,b=n.innerHeight,_=n.config.legendCrosshairColor,M=c.getColumn(g,"number"),w=c.getColumn(m,"number"),C=c.getColumn(G,"string"),T=function(t,e,n,r,i,o,u,l){var c=e.getColumn(n,"number"),s=e.getColumn(r,"number"),f=e.getColumn(i,"string"),h=t.map(function(t){return l(f[t])}),g=o(n),m=o(r);return a([{key:n,name:e.getColumnName(n),type:e.getColumnType(n),colors:h,values:t.map(function(t){return g(c[t])})},{key:r,name:e.getColumnName(r),type:e.getColumnType(r),colors:h,values:t.map(function(t){return m(s[t])})}],J(e,t,u,o,h))}(u,c,g,m,G,n.getFormatterForColumn,d,s),k=function(t,e,n,r,i,o,a){var u=t.getColumn(n,"number"),l=t.getColumn(r,"number"),c=t.getColumn(G,"string");return e.map(function(t){return{x:i(u[t]),y:o(l[t]),fill:a(c[t])}})}(c,u,g,m,p,v,s),S="xy"===l||"x"===l?p(M[u[0]]):null,N="xy"===l||"y"===l?v(w[u[0]]):null,F=e.useRef(null);return e.useLayoutEffect(function(){var t,e=F.current;if(j(e,x,b),"xy"===l){var n=C[u[0]],r=o[n];ot({canvas:e,lineData:(t={},t[n]=r,t),interpolation:h,lineWidth:2*y})}!function(t){var e,n,r=t.canvas,o=t.width,a=t.height,u=t.crosshairX,l=t.crosshairY,c=t.crosshairColor,s=t.points,f=t.radius,h=r.getContext("2d");if(h.strokeStyle=c,null!==u&&(h.lineWidth=1,h.beginPath(),h.moveTo(u,0),h.lineTo(u,a),h.stroke()),null!==l&&(h.lineWidth=1,h.beginPath(),h.moveTo(0,l),h.lineTo(o,l),h.stroke()),null!==s)try{for(var g=i(s),m=g.next();!m.done;m=g.next()){var d=m.value,y=d.x,p=d.y,v=d.fill;h.beginPath(),h.arc(y,p,f,0,2*Math.PI),h.fillStyle=v,h.fill()}}catch(t){e={error:t}}finally{try{m&&!m.done&&(n=g.return)&&n.call(g)}finally{if(e)throw e.error}}}({canvas:e,width:x,height:b,crosshairX:S,crosshairY:N,crosshairColor:_,points:k,radius:2*y})}),e.createElement(e.Fragment,null,e.createElement("canvas",{className:"vis-layer line-interactions",ref:F,style:{position:"absolute"}}),e.createElement(nt,{data:T,env:n}))},st=function(t,e){var n,r,o,a,u=[],l=e.map(t);try{for(var c=i(l),s=c.next();!s.done;s=c.next()){var f=s.value;try{for(var h=i(f),g=h.next();!g.done;g=h.next()){var m=g.value;u.push(m)}}catch(t){o={error:t}}finally{try{g&&!g.done&&(a=h.return)&&a.call(h)}finally{if(o)throw o.error}}}}catch(t){n={error:t}}finally{try{s&&!s.done&&(r=c.return)&&r.call(c)}finally{if(n)throw n.error}}return u},ft=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];var n=B(st(function(t){return B(t)},t));return n.some(function(t){return void 0===t})?null:n},ht=function(t,n,r,i,o,a,u,l,c,s){var f,h,g,m,d,y,p=null!=n&&n>=0&&n<c,v=(f=function(){return gt(i,o,u,l,c,s)},h=[i,o,u,l,c,s],g=p,m=e.useRef(!1),d=e.useRef(null),y=e.useRef(h),g?m.current?(h.some(function(t,e){return t!==y.current[e]})&&(d.current=f(),y.current=h),d.current):(m.current=!0,d.current=f(),y.current=h,d.current):null);return p?"x"===t?vt(v.xBins,n,u.invert(n),i,a,c):"y"===t?vt(v.yBins,r,l.invert(r),o,a,s):dt(v.xyBins,n,r,u.invert(n),l.invert(r),i,o,c,s):null},gt=function(t,e,n,r,i,o){for(var a=Math.ceil(i/30),u=Math.ceil(o/30),l={xBins:X(a).map(function(t){return[]}),yBins:X(u).map(function(t){return[]}),xyBins:X(a).map(function(t){return X(u).map(function(t){return[]})})},c=0;c<t.length;c++){var s=n(t[c]),f=r(e[c]);if(it(s)&&it(f)){var h=mt(s,i),g=mt(f,o);h<0||h>=a||g<0||g>=u||(l.xBins[h].push(c),l.yBins[g].push(c),l.xyBins[h][g].push(c))}}return l},mt=function(t,e){var n=Math.ceil(e/30);return Math.floor(t/e*n)},dt=function(t,e,n,r,o,a,u,l,c){for(var s=t.length,f=t[0].length,h=Math.max(0,mt(e,l)),g=Math.min(s-1,mt(e,l)),m=Math.max(0,mt(n,c)),d=Math.min(f-1,mt(n,c)),y=t[h][m],p=0===h&&g===s-1&&0===m&&d===f-1;0===y.length&&!p;)h=Math.max(0,h-1),g=Math.min(s-1,g+1),m=Math.max(0,m-1),d=Math.min(f-1,d+1),y=yt(h,g,m,d,t),p=0===h&&g===s-1&&0===m&&d===f-1;return 0===y.length?[]:[function(t,e){var n,r,o=null,a=1/0;try{for(var u=i(e),l=u.next();!l.done;l=u.next()){var c=l.value,s=t(c);s<a&&(o=c,a=s)}}catch(t){n={error:t}}finally{try{l&&!l.done&&(r=u.return)&&r.call(u)}finally{if(n)throw n.error}}return o}(function(t){return pt(r,o,a[t],u[t])},y)]},yt=function(t,e,n,r,i){for(var o=[],u=t,l=n;u<=e;)o.push.apply(o,a(i[u][l])),u++;for(u--,l++;l<=r;)o.push.apply(o,a(i[u][l])),l++;for(l--,u--;u>=t;)o.push.apply(o,a(i[u][l])),u--;for(u++,l--;l>=n;)o.push.apply(o,a(i[u][l])),l--;return o},pt=function(t,e,n,r){return Math.pow(n-t,2)+Math.pow(r-e,2)},vt=function(t,e,n,r,i,o){for(var u=mt(e,o),l=t.length-1,c=Math.max(0,u-1),s=Math.min(u,l),f=t[c],h=t[s];!(f.length||h.length||0===c&&s===l);)c=Math.max(0,c-1),s=Math.min(s+1,l),f=t[c],h=t[s];var g={};xt(g,f,n,r,i),xt(g,h,n,r,i);var m=Object.values(g);if(!m.length)return[];var d=Math.min.apply(Math,a(m.map(function(t){return t.distance})));return m.filter(function(t){return t.distance===d}).map(function(t){return t.i})},xt=function(t,e,n,r,o){var a,u;try{for(var l=i(e),c=l.next();!c.done;c=l.next()){var s=c.value,f=o[s],h=Math.floor(Math.abs(n-r[s]));(!t[f]||h<t[f].distance)&&(t[f]={i:s,distance:h})}}catch(t){a={error:t}}finally{try{c&&!c.done&&(u=l.return)&&u.call(l)}finally{if(a)throw a.error}}},bt=function(t){var n=t.env,r=t.layerIndex,a=t.hoverX,u=t.hoverY,l=n.getTable(r),c=n.getScale(r,"fill"),s=n.xScale,f=n.yScale,h=n.innerWidth,g=n.innerHeight,m=n.config.layers[r],d=m.interpolation,y=m.x,p=m.y,v=m.lineWidth,x=m.hoverDimension,b=m.maxTooltipRows,_=l.getColumn(y,"number"),M=l.getColumn(p,"number"),w=l.getColumn(G,"string"),C=e.useMemo(function(){return function(t,e,n,r){for(var i=t.getColumn(e,"number"),o=t.getColumn(n,"number"),a=t.getColumn(G,"string"),u={},l=0;l<t.length;l++){var c=a[l];u[c]||(u[c]={xs:[],ys:[],fill:r(c)}),u[c].xs.push(i[l]),u[c].ys.push(o[l])}return u}(l,y,p,c)},[l,y,p,c]),T=e.useMemo(function(){return function(t,e,n){var r,a,u={};try{for(var l=i(Object.entries(t)),c=l.next();!c.done;c=l.next()){var s=o(c.value,2),f=s[0],h=s[1],g=h.xs,m=h.ys,d=h.fill,y=o(lt(g.map(function(t){return e(t)}),m.map(function(t){return n(t)}),1),2),p=y[0],v=y[1];u[f]={xs:p,ys:v,fill:d}}}catch(t){r={error:t}}finally{try{c&&!c.done&&(a=l.return)&&a.call(l)}finally{if(r)throw r.error}}return u}(C,s,f)},[C,s,f]),k="auto"===x?Object.keys(C).length>b?"xy":"x":x,S=e.useRef(null);e.useLayoutEffect(function(){j(S.current,h,g),ot({canvas:S.current,lineData:T,interpolation:d,lineWidth:v})},[T,S.current,d,h,g]);var N=ht(k,a,u,_,M,w,s,f,h,g),F=N&&N.length>0;return e.createElement(e.Fragment,null,e.createElement("canvas",{className:"vis-layer line",ref:S,style:{position:"absolute",opacity:"xy"===k&&F?.4:1}}),F&&e.createElement(ct,{env:n,layerIndex:r,lineData:T,rowIndices:N,dimension:k}))};function _t(t,e,n){t.prototype=e.prototype=n,n.constructor=t}function Mt(t,e){var n=Object.create(t.prototype);for(var r in e)n[r]=e[r];return n}function wt(){}var Ct="\\s*([+-]?\\d+)\\s*",Tt="\\s*([+-]?\\d*\\.?\\d+(?:[eE][+-]?\\d+)?)\\s*",kt="\\s*([+-]?\\d*\\.?\\d+(?:[eE][+-]?\\d+)?)%\\s*",St=/^#([0-9a-f]{3})$/,Nt=/^#([0-9a-f]{6})$/,Ft=new RegExp("^rgb\\("+[Ct,Ct,Ct]+"\\)$"),Dt=new RegExp("^rgb\\("+[kt,kt,kt]+"\\)$"),Et=new RegExp("^rgba\\("+[Ct,Ct,Ct,Tt]+"\\)$"),At=new RegExp("^rgba\\("+[kt,kt,kt,Tt]+"\\)$"),Lt=new RegExp("^hsl\\("+[Tt,kt,kt]+"\\)$"),zt=new RegExp("^hsla\\("+[Tt,kt,kt,Tt]+"\\)$"),Ut={aliceblue:15792383,antiquewhite:16444375,aqua:65535,aquamarine:8388564,azure:15794175,beige:16119260,bisque:16770244,black:0,blanchedalmond:16772045,blue:255,blueviolet:9055202,brown:10824234,burlywood:14596231,cadetblue:6266528,chartreuse:8388352,chocolate:13789470,coral:16744272,cornflowerblue:6591981,cornsilk:16775388,crimson:14423100,cyan:65535,darkblue:139,darkcyan:35723,darkgoldenrod:12092939,darkgray:11119017,darkgreen:25600,darkgrey:11119017,darkkhaki:12433259,darkmagenta:9109643,darkolivegreen:5597999,darkorange:16747520,darkorchid:10040012,darkred:9109504,darksalmon:15308410,darkseagreen:9419919,darkslateblue:4734347,darkslategray:3100495,darkslategrey:3100495,darkturquoise:52945,darkviolet:9699539,deeppink:16716947,deepskyblue:49151,dimgray:6908265,dimgrey:6908265,dodgerblue:2003199,firebrick:11674146,floralwhite:16775920,forestgreen:2263842,fuchsia:16711935,gainsboro:14474460,ghostwhite:16316671,gold:16766720,goldenrod:14329120,gray:8421504,green:32768,greenyellow:11403055,grey:8421504,honeydew:15794160,hotpink:16738740,indianred:13458524,indigo:4915330,ivory:16777200,khaki:15787660,lavender:15132410,lavenderblush:16773365,lawngreen:8190976,lemonchiffon:16775885,lightblue:11393254,lightcoral:15761536,lightcyan:14745599,lightgoldenrodyellow:16448210,lightgray:13882323,lightgreen:9498256,lightgrey:13882323,lightpink:16758465,lightsalmon:16752762,lightseagreen:2142890,lightskyblue:8900346,lightslategray:7833753,lightslategrey:7833753,lightsteelblue:11584734,lightyellow:16777184,lime:65280,limegreen:3329330,linen:16445670,magenta:16711935,maroon:8388608,mediumaquamarine:6737322,mediumblue:205,mediumorchid:12211667,mediumpurple:9662683,mediumseagreen:3978097,mediumslateblue:8087790,mediumspringgreen:64154,mediumturquoise:4772300,mediumvioletred:13047173,midnightblue:1644912,mintcream:16121850,mistyrose:16770273,moccasin:16770229,navajowhite:16768685,navy:128,oldlace:16643558,olive:8421376,olivedrab:7048739,orange:16753920,orangered:16729344,orchid:14315734,palegoldenrod:15657130,palegreen:10025880,paleturquoise:11529966,palevioletred:14381203,papayawhip:16773077,peachpuff:16767673,peru:13468991,pink:16761035,plum:14524637,powderblue:11591910,purple:8388736,rebeccapurple:6697881,red:16711680,rosybrown:12357519,royalblue:4286945,saddlebrown:9127187,salmon:16416882,sandybrown:16032864,seagreen:3050327,seashell:16774638,sienna:10506797,silver:12632256,skyblue:8900331,slateblue:6970061,slategray:7372944,slategrey:7372944,snow:16775930,springgreen:65407,steelblue:4620980,tan:13808780,teal:32896,thistle:14204888,tomato:16737095,turquoise:4251856,violet:15631086,wheat:16113331,white:16777215,whitesmoke:16119285,yellow:16776960,yellowgreen:10145074};function Pt(t){var e;return t=(t+"").trim().toLowerCase(),(e=St.exec(t))?new Ht((e=parseInt(e[1],16))>>8&15|e>>4&240,e>>4&15|240&e,(15&e)<<4|15&e,1):(e=Nt.exec(t))?Rt(parseInt(e[1],16)):(e=Ft.exec(t))?new Ht(e[1],e[2],e[3],1):(e=Dt.exec(t))?new Ht(255*e[1]/100,255*e[2]/100,255*e[3]/100,1):(e=Et.exec(t))?Ot(e[1],e[2],e[3],e[4]):(e=At.exec(t))?Ot(255*e[1]/100,255*e[2]/100,255*e[3]/100,e[4]):(e=Lt.exec(t))?It(e[1],e[2]/100,e[3]/100,1):(e=zt.exec(t))?It(e[1],e[2]/100,e[3]/100,e[4]):Ut.hasOwnProperty(t)?Rt(Ut[t]):"transparent"===t?new Ht(NaN,NaN,NaN,0):null}function Rt(t){return new Ht(t>>16&255,t>>8&255,255&t,1)}function Ot(t,e,n,r){return r<=0&&(t=e=n=NaN),new Ht(t,e,n,r)}function jt(t){return t instanceof wt||(t=Pt(t)),t?new Ht((t=t.rgb()).r,t.g,t.b,t.opacity):new Ht}function Yt(t,e,n,r){return 1===arguments.length?jt(t):new Ht(t,e,n,null==r?1:r)}function Ht(t,e,n,r){this.r=+t,this.g=+e,this.b=+n,this.opacity=+r}function Wt(t){return((t=Math.max(0,Math.min(255,Math.round(t)||0)))<16?"0":"")+t.toString(16)}function It(t,e,n,r){return r<=0?t=e=n=NaN:n<=0||n>=1?t=e=NaN:e<=0&&(t=NaN),new Bt(t,e,n,r)}function Bt(t,e,n,r){this.h=+t,this.s=+e,this.l=+n,this.opacity=+r}function Xt(t,e,n){return 255*(t<60?e+(n-e)*t/60:t<180?n:t<240?e+(n-e)*(240-t)/60:e)}_t(wt,Pt,{displayable:function(){return this.rgb().displayable()},hex:function(){return this.rgb().hex()},toString:function(){return this.rgb()+""}}),_t(Ht,Yt,Mt(wt,{brighter:function(t){return t=null==t?1/.7:Math.pow(1/.7,t),new Ht(this.r*t,this.g*t,this.b*t,this.opacity)},darker:function(t){return t=null==t?.7:Math.pow(.7,t),new Ht(this.r*t,this.g*t,this.b*t,this.opacity)},rgb:function(){return this},displayable:function(){return 0<=this.r&&this.r<=255&&0<=this.g&&this.g<=255&&0<=this.b&&this.b<=255&&0<=this.opacity&&this.opacity<=1},hex:function(){return"#"+Wt(this.r)+Wt(this.g)+Wt(this.b)},toString:function(){var t=this.opacity;return(1===(t=isNaN(t)?1:Math.max(0,Math.min(1,t)))?"rgb(":"rgba(")+Math.max(0,Math.min(255,Math.round(this.r)||0))+", "+Math.max(0,Math.min(255,Math.round(this.g)||0))+", "+Math.max(0,Math.min(255,Math.round(this.b)||0))+(1===t?")":", "+t+")")}})),_t(Bt,function(t,e,n,r){return 1===arguments.length?function(t){if(t instanceof Bt)return new Bt(t.h,t.s,t.l,t.opacity);if(t instanceof wt||(t=Pt(t)),!t)return new Bt;if(t instanceof Bt)return t;var e=(t=t.rgb()).r/255,n=t.g/255,r=t.b/255,i=Math.min(e,n,r),o=Math.max(e,n,r),a=NaN,u=o-i,l=(o+i)/2;return u?(a=e===o?(n-r)/u+6*(n<r):n===o?(r-e)/u+2:(e-n)/u+4,u/=l<.5?o+i:2-o-i,a*=60):u=l>0&&l<1?0:a,new Bt(a,u,l,t.opacity)}(t):new Bt(t,e,n,null==r?1:r)},Mt(wt,{brighter:function(t){return t=null==t?1/.7:Math.pow(1/.7,t),new Bt(this.h,this.s,this.l*t,this.opacity)},darker:function(t){return t=null==t?.7:Math.pow(.7,t),new Bt(this.h,this.s,this.l*t,this.opacity)},rgb:function(){var t=this.h%360+360*(this.h<0),e=isNaN(t)||isNaN(this.s)?0:this.s,n=this.l,r=n+(n<.5?n:1-n)*e,i=2*n-r;return new Ht(Xt(t>=240?t-240:t+120,i,r),Xt(t,i,r),Xt(t<120?t+240:t-120,i,r),this.opacity)},displayable:function(){return(0<=this.s&&this.s<=1||isNaN(this.s))&&0<=this.l&&this.l<=1&&0<=this.opacity&&this.opacity<=1}}));var qt=Math.PI/180,$t=180/Math.PI,Zt=.96422,Kt=1,Vt=.82521,Qt=4/29,Jt=6/29,Gt=3*Jt*Jt,te=Jt*Jt*Jt;function ee(t){if(t instanceof ne)return new ne(t.l,t.a,t.b,t.opacity);if(t instanceof ue){if(isNaN(t.h))return new ne(t.l,0,0,t.opacity);var e=t.h*qt;return new ne(t.l,Math.cos(e)*t.c,Math.sin(e)*t.c,t.opacity)}t instanceof Ht||(t=jt(t));var n,r,i=ae(t.r),o=ae(t.g),a=ae(t.b),u=re((.2225045*i+.7168786*o+.0606169*a)/Kt);return i===o&&o===a?n=r=u:(n=re((.4360747*i+.3850649*o+.1430804*a)/Zt),r=re((.0139322*i+.0971045*o+.7141733*a)/Vt)),new ne(116*u-16,500*(n-u),200*(u-r),t.opacity)}function ne(t,e,n,r){this.l=+t,this.a=+e,this.b=+n,this.opacity=+r}function re(t){return t>te?Math.pow(t,1/3):t/Gt+Qt}function ie(t){return t>Jt?t*t*t:Gt*(t-Qt)}function oe(t){return 255*(t<=.0031308?12.92*t:1.055*Math.pow(t,1/2.4)-.055)}function ae(t){return(t/=255)<=.04045?t/12.92:Math.pow((t+.055)/1.055,2.4)}function ue(t,e,n,r){this.h=+t,this.c=+e,this.l=+n,this.opacity=+r}_t(ne,function(t,e,n,r){return 1===arguments.length?ee(t):new ne(t,e,n,null==r?1:r)},Mt(wt,{brighter:function(t){return new ne(this.l+18*(null==t?1:t),this.a,this.b,this.opacity)},darker:function(t){return new ne(this.l-18*(null==t?1:t),this.a,this.b,this.opacity)},rgb:function(){var t=(this.l+16)/116,e=isNaN(this.a)?t:t+this.a/500,n=isNaN(this.b)?t:t-this.b/200;return new Ht(oe(3.1338561*(e=Zt*ie(e))-1.6168667*(t=Kt*ie(t))-.4906146*(n=Vt*ie(n))),oe(-.9787684*e+1.9161415*t+.033454*n),oe(.0719453*e-.2289914*t+1.4052427*n),this.opacity)}})),_t(ue,function(t,e,n,r){return 1===arguments.length?function(t){if(t instanceof ue)return new ue(t.h,t.c,t.l,t.opacity);if(t instanceof ne||(t=ee(t)),0===t.a&&0===t.b)return new ue(NaN,0,t.l,t.opacity);var e=Math.atan2(t.b,t.a)*$t;return new ue(e<0?e+360:e,Math.sqrt(t.a*t.a+t.b*t.b),t.l,t.opacity)}(t):new ue(t,e,n,null==r?1:r)},Mt(wt,{brighter:function(t){return new ue(this.h,this.c,this.l+18*(null==t?1:t),this.opacity)},darker:function(t){return new ue(this.h,this.c,this.l-18*(null==t?1:t),this.opacity)},rgb:function(){return ee(this).rgb()}}));var le=-.14861,ce=1.78277,se=-.29227,fe=-.90649,he=1.97294,ge=he*fe,me=he*ce,de=ce*se-fe*le;function ye(t,e,n,r){this.h=+t,this.s=+e,this.l=+n,this.opacity=+r}_t(ye,function(t,e,n,r){return 1===arguments.length?function(t){if(t instanceof ye)return new ye(t.h,t.s,t.l,t.opacity);t instanceof Ht||(t=jt(t));var e=t.r/255,n=t.g/255,r=t.b/255,i=(de*r+ge*e-me*n)/(de+ge-me),o=r-i,a=(he*(n-i)-se*o)/fe,u=Math.sqrt(a*a+o*o)/(he*i*(1-i)),l=u?Math.atan2(a,o)*$t-120:NaN;return new ye(l<0?l+360:l,u,i,t.opacity)}(t):new ye(t,e,n,null==r?1:r)},Mt(wt,{brighter:function(t){return t=null==t?1/.7:Math.pow(1/.7,t),new ye(this.h,this.s,this.l*t,this.opacity)},darker:function(t){return t=null==t?.7:Math.pow(.7,t),new ye(this.h,this.s,this.l*t,this.opacity)},rgb:function(){var t=isNaN(this.h)?0:(this.h+120)*qt,e=+this.l,n=isNaN(this.s)?0:this.s*e*(1-e),r=Math.cos(t),i=Math.sin(t);return new Ht(255*(e+n*(le*r+ce*i)),255*(e+n*(se*r+fe*i)),255*(e+n*(he*r)),this.opacity)}}));var pe=function(t){var e,n,r=t.canvas,o=t.width,a=t.height,u=t.table,l=t.xScale,c=t.yScale,s=t.fillScale,f=t.rows,h=t.brighten;j(r,o,a);var g=r.getContext("2d"),m=f||X(u.length),d=u.getColumn("xMin","number"),y=u.getColumn("xMax","number"),p=u.getColumn("yMin","number"),v=u.getColumn("yMax","number"),x=u.getColumn("count","number");try{for(var b=i(m),_=b.next();!_.done;_=b.next()){var M=_.value,w=d[M],C=y[M],T=p[M],k=v[M],S=x[M],N=l(w),F=c(k),D=l(C)-N,E=c(T)-F,A=s(S);h&&(A=Pt(A).brighter(3).hex()),g.beginPath(),g.rect(N,F,D,E),g.fillStyle=A,g.fill()}}catch(t){e={error:t}}finally{try{_&&!_.done&&(n=b.return)&&n.call(b)}finally{if(e)throw e.error}}},ve=function(t){var n=t.layerIndex,r=t.env,i=t.hoveredRowIndices,o=r.innerWidth,a=r.innerHeight,u=r.xScale,l=r.yScale,c=r.config,s=c.table,f=c.layers[n],h=f.x,g=f.y,m=s.getColumnName(h),d=s.getColumnName(g),y=r.getTable(n),p=r.getScale(n,"fill"),v=function(t,e,n,r,i,o,a){if(!t||0===t.length)return null;var u=a.getColumn("xMin","number"),l=a.getColumn("xMax","number"),c=a.getColumn("yMin","number"),s=a.getColumn("yMax","number"),f=a.getColumn("count","number"),h=o(e),g=o(n),m=o("count");return[{key:e,name:r,type:"number",colors:null,values:t.map(function(t){return Q(u[t],l[t],h)})},{key:n,name:i,type:"number",colors:null,values:t.map(function(t){return Q(c[t],s[t],g)})},{key:"count",name:"count",type:"number",colors:null,values:t.map(function(t){return m(f[t])})}]}(i,h,g,m,d,r.getFormatterForColumn,y),x=e.useRef(null);return e.useLayoutEffect(function(){return pe({canvas:x.current,width:o,height:a,table:y,xScale:u,yScale:l,fillScale:p,brighten:1,rows:i})},[x.current,o,a,y,u,l,p,i]),e.createElement(e.Fragment,null,e.createElement("canvas",{className:"vis-layer heatmap-interactions",ref:x,style:{position:"absolute",top:0,left:0}}),v&&e.createElement(nt,{data:v,env:r}))},xe=function(t){var n=t.layerIndex,r=t.env,i=t.hoverX,o=t.hoverY,a=r.innerWidth,u=r.innerHeight,l=r.xScale,c=r.yScale,s=r.getScale(n,"fill"),f=r.getTable(n),h=null;i&&o&&(h=function(t,e,n){var r=t.getColumn("xMin","number"),i=t.getColumn("xMax","number"),o=t.getColumn("yMin","number"),a=t.getColumn("yMax","number"),u=t.getColumn("count","number");return X(t.length).filter(function(t){return r[t]<=e&&i[t]>e&&o[t]<=n&&a[t]>n&&0!==u[t]})}(f,l.invert(i),c.invert(o)));var g=e.useRef(null);return e.useLayoutEffect(function(){return pe({canvas:g.current,width:a,height:u,table:f,xScale:l,yScale:c,fillScale:s})},[g.current,a,u,f,l,c,s]),e.createElement(e.Fragment,null,e.createElement("canvas",{className:"vis-layer heatmap",ref:g}),h&&h.length>0&&e.createElement(ve,{layerIndex:n,env:r,hoveredRowIndices:h}))},be=function(t,e,n,r){void 0===r&&(r=5),t.lineWidth=r,t.beginPath(),t.lineCap="round",t.moveTo(e,n),t.lineTo(e,n),t.stroke(),t.lineCap="butt"},_e=function(t,e,n,r){void 0===r&&(r=4);var i=e-r/2,o=n-r/2;t.rect(i,o,r,r),t.fill()},Me=function(t,e,n,r){void 0===r&&(r=6);var i=r/2;t.lineWidth=1,t.beginPath(),t.moveTo(e-i,n),t.lineTo(e+i,n),t.stroke(),t.beginPath(),t.moveTo(e,n-i),t.lineTo(e,n+i),t.stroke()},we=function(t,e,n,r){void 0===r&&(r=6);var i=r/2;t.lineWidth=1,t.beginPath(),t.moveTo(e-i,n-i),t.lineTo(e+i,n+i),t.closePath(),t.stroke(),t.beginPath(),t.moveTo(e-i,n+i),t.lineTo(e+i,n-i),t.closePath(),t.stroke()},Ce=function(t,e,n,r){void 0===r&&(r=3);t.lineWidth=1,t.beginPath(),t.moveTo(e,n),t.lineTo(e+.86602540378*r,n+.5*r),t.closePath(),t.stroke(),t.beginPath(),t.moveTo(e,n),t.lineTo(e-.86602540378*r,n+.5*r),t.closePath(),t.stroke(),t.beginPath(),t.moveTo(e,n),t.lineTo(e,n-r),t.closePath(),t.stroke()},Te=function(t){var n=t.env,r=t.layerIndex,i=e.useRef(null),o=n.getTable(r),a=n.getScale(r,"fill"),u=n.getScale(r,"symbol"),l=n.config.layers[r],c=l.x,s=l.y,f=n.xScale,h=n.yScale,g=n.innerWidth,m=n.innerHeight,d=e.useMemo(function(){return function(t,e,n,r,i){return{xs:t.getColumn(e,"number"),ys:t.getColumn(n,"number"),fill:t.getColumn(G,"string").map(r),symbol:t.getColumn("__symbol","string").map(i)}}(o,c,s,a,u)},[o,c,s,a,u]);return e.useLayoutEffect(function(){!function(t){var e=t.canvas,n=t.scatterData,r=n.xs,i=n.ys,o=n.fill,a=n.symbol,u=t.width,l=t.height,c=t.xScale,s=t.yScale;j(e,u,l);for(var f,h,g,m,d=e.getContext("2d"),y=0;y<r.length;y++){var p=c(r[y]),v=s(i[y]),x=o[y];d.fillStyle=x,d.strokeStyle=x;var b=a[y];"circle"===b?be(d,p,v):"square"===b?_e(d,p,v):"triangle"===b?(h=p,g=v,void 0===(m=void 0)&&(m=3),(f=d).beginPath(),f.moveTo(h-m,g+m),f.lineTo(h+m,g+m),f.lineTo(h,g-m),f.fill()):"plus"===b?Me(d,p,v):"tritip"===b?Ce(d,p,v):"ex"===b&&we(d,p,v)}}({canvas:i.current,scatterData:d,width:g,height:m,xScale:f,yScale:h})},[i.current,d,g,m,f,h]),e.createElement("canvas",{className:"vis-layer scatter",ref:i})},ke=function(t,e,n){var r=o(t,2),i=r[0],a=r[1];return[e.invert(Math.max(Math.min(i,a),0)),e.invert(Math.min(Math.max(i,a),n))]},Se=function(t){var n=t.event,r=t.width,i=t.height,o=t.onXBrushEnd,a=t.onYBrushEnd;if(e.useLayoutEffect(function(){if(n&&n.dragMode&&"dragend"===n.type){var t,e,r;if("brushX"===n.dragMode)t=Math.min(n.initialX,n.x),e=Math.max(n.initialX,n.x),r=o;else{if("brushY"!==n.dragMode)return;t=Math.min(n.initialY,n.y),e=Math.max(n.initialY,n.y),r=a}e-t<5||r([t,e])}}),!n||!n.dragMode||"dragend"===n.type)return null;var u=function(t,e,n){if("brushX"===t.dragMode){var r=Math.max(0,Math.min(t.initialX,t.x));return{x:r,y:0,width:Math.min(Math.max(t.initialX,t.x)-r,e-r),height:n}}if("brushY"===t.dragMode){var i=Math.max(0,Math.min(t.initialY,t.y));return{x:0,y:i,width:e,height:Math.min(Math.max(t.initialY,t.y)-i,n-i)}}return null}(n,r,i),l=u.x,c=u.y,s=u.width,f=u.height,h={display:null===n.initialX?"none":"inherit",position:"absolute",left:l+"px",width:s+"px",top:c+"px",height:f+"px",opacity:.1,backgroundColor:"aliceblue"};return e.createElement("div",{className:"vis-brush-selection",style:h})};function Ne(t,e){return t<e?-1:t>e?1:t>=e?0:NaN}function Fe(t){var e;return 1===t.length&&(e=t,t=function(t,n){return Ne(e(t),n)}),{left:function(e,n,r,i){for(null==r&&(r=0),null==i&&(i=e.length);r<i;){var o=r+i>>>1;t(e[o],n)<0?r=o+1:i=o}return r},right:function(e,n,r,i){for(null==r&&(r=0),null==i&&(i=e.length);r<i;){var o=r+i>>>1;t(e[o],n)>0?i=o:r=o+1}return r}}}var De=Fe(Ne).right,Ee=Math.sqrt(50),Ae=Math.sqrt(10),Le=Math.sqrt(2);function ze(t,e,n){var r=(e-t)/Math.max(0,n),i=Math.floor(Math.log(r)/Math.LN10),o=r/Math.pow(10,i);return i>=0?(o>=Ee?10:o>=Ae?5:o>=Le?2:1)*Math.pow(10,i):-Math.pow(10,-i)/(o>=Ee?10:o>=Ae?5:o>=Le?2:1)}function Ue(t,e,n){var r=Math.abs(e-t)/Math.max(0,n),i=Math.pow(10,Math.floor(Math.log(r)/Math.LN10)),o=r/i;return o>=Ee?i*=10:o>=Ae?i*=5:o>=Le&&(i*=2),e<t?-i:i}function Pe(t,e){switch(arguments.length){case 0:break;case 1:this.range(t);break;default:this.range(e).domain(t)}return this}function Re(){}function Oe(t,e){var n=new Re;if(t instanceof Re)t.each(function(t,e){n.set(e,t)});else if(Array.isArray(t)){var r,i=-1,o=t.length;if(null==e)for(;++i<o;)n.set(i,t[i]);else for(;++i<o;)n.set(e(r=t[i],i,t),r)}else if(t)for(var a in t)n.set(a,t[a]);return n}function je(){}Re.prototype=Oe.prototype={constructor:Re,has:function(t){return"$"+t in this},get:function(t){return this["$"+t]},set:function(t,e){return this["$"+t]=e,this},remove:function(t){var e="$"+t;return e in this&&delete this[e]},clear:function(){for(var t in this)"$"===t[0]&&delete this[t]},keys:function(){var t=[];for(var e in this)"$"===e[0]&&t.push(e.slice(1));return t},values:function(){var t=[];for(var e in this)"$"===e[0]&&t.push(this[e]);return t},entries:function(){var t=[];for(var e in this)"$"===e[0]&&t.push({key:e.slice(1),value:this[e]});return t},size:function(){var t=0;for(var e in this)"$"===e[0]&&++t;return t},empty:function(){for(var t in this)if("$"===t[0])return!1;return!0},each:function(t){for(var e in this)"$"===e[0]&&t(this[e],e.slice(1),this)}};var Ye=Oe.prototype;je.prototype=function(t,e){var n=new je;if(t instanceof je)t.each(function(t){n.add(t)});else if(t){var r=-1,i=t.length;if(null==e)for(;++r<i;)n.add(t[r]);else for(;++r<i;)n.add(e(t[r],r,t))}return n}.prototype={constructor:je,has:Ye.has,add:function(t){return this["$"+(t+="")]=t,this},remove:Ye.remove,clear:Ye.clear,values:Ye.keys,size:Ye.size,empty:Ye.empty,each:Ye.each};var He=Array.prototype,We=He.map,Ie=He.slice,Be={name:"implicit"};function Xe(){var t=Oe(),e=[],n=[],r=Be;function i(i){var o=i+"",a=t.get(o);if(!a){if(r!==Be)return r;t.set(o,a=e.push(i))}return n[(a-1)%n.length]}return i.domain=function(n){if(!arguments.length)return e.slice();e=[],t=Oe();for(var r,o,a=-1,u=n.length;++a<u;)t.has(o=(r=n[a])+"")||t.set(o,e.push(r));return i},i.range=function(t){return arguments.length?(n=Ie.call(t),i):n.slice()},i.unknown=function(t){return arguments.length?(r=t,i):r},i.copy=function(){return Xe(e,n).unknown(r)},Pe.apply(i,arguments),i}function qe(t){return function(){return t}}function $e(t){return 1==(t=+t)?Ze:function(e,n){return n-e?function(t,e,n){return t=Math.pow(t,n),e=Math.pow(e,n)-t,n=1/n,function(r){return Math.pow(t+r*e,n)}}(e,n,t):qe(isNaN(e)?n:e)}}function Ze(t,e){var n=e-t;return n?function(t,e){return function(n){return t+n*e}}(t,n):qe(isNaN(t)?e:t)}var Ke=function t(e){var n=$e(e);function r(t,e){var r=n((t=Yt(t)).r,(e=Yt(e)).r),i=n(t.g,e.g),o=n(t.b,e.b),a=Ze(t.opacity,e.opacity);return function(e){return t.r=r(e),t.g=i(e),t.b=o(e),t.opacity=a(e),t+""}}return r.gamma=t,r}(1);var Ve,Qe=(Ve=function(t){var e=t.length-1;return function(n){var r=n<=0?n=0:n>=1?(n=1,e-1):Math.floor(n*e),i=t[r],o=t[r+1],a=r>0?t[r-1]:2*i-o,u=r<e-1?t[r+2]:2*o-i;return function(t,e,n,r,i){var o=t*t,a=o*t;return((1-3*t+3*o-a)*e+(4-6*o+3*a)*n+(1+3*t+3*o-3*a)*r+a*i)/6}((n-r/e)*e,a,i,o,u)}},function(t){var e,n,r=t.length,i=new Array(r),o=new Array(r),a=new Array(r);for(e=0;e<r;++e)n=Yt(t[e]),i[e]=n.r||0,o[e]=n.g||0,a[e]=n.b||0;return i=Ve(i),o=Ve(o),a=Ve(a),n.opacity=1,function(t){return n.r=i(t),n.g=o(t),n.b=a(t),n+""}});function Je(t,e){return e-=t=+t,function(n){return t+e*n}}var Ge=/[-+]?(?:\d+\.?\d*|\.?\d+)(?:[eE][-+]?\d+)?/g,tn=new RegExp(Ge.source,"g");function en(t,e){var n,r=typeof e;return null==e||"boolean"===r?qe(e):("number"===r?Je:"string"===r?(n=Pt(e))?(e=n,Ke):function(t,e){var n,r,i,o=Ge.lastIndex=tn.lastIndex=0,a=-1,u=[],l=[];for(t+="",e+="";(n=Ge.exec(t))&&(r=tn.exec(e));)(i=r.index)>o&&(i=e.slice(o,i),u[a]?u[a]+=i:u[++a]=i),(n=n[0])===(r=r[0])?u[a]?u[a]+=r:u[++a]=r:(u[++a]=null,l.push({i:a,x:Je(n,r)})),o=tn.lastIndex;return o<e.length&&(i=e.slice(o),u[a]?u[a]+=i:u[++a]=i),u.length<2?l[0]?function(t){return function(e){return t(e)+""}}(l[0].x):function(t){return function(){return t}}(e):(e=l.length,function(t){for(var n,r=0;r<e;++r)u[(n=l[r]).i]=n.x(t);return u.join("")})}:e instanceof Pt?Ke:e instanceof Date?function(t,e){var n=new Date;return e-=t=+t,function(r){return n.setTime(t+e*r),n}}:Array.isArray(e)?function(t,e){var n,r=e?e.length:0,i=t?Math.min(r,t.length):0,o=new Array(i),a=new Array(r);for(n=0;n<i;++n)o[n]=en(t[n],e[n]);for(;n<r;++n)a[n]=e[n];return function(t){for(n=0;n<i;++n)a[n]=o[n](t);return a}}:"function"!=typeof e.valueOf&&"function"!=typeof e.toString||isNaN(e)?function(t,e){var n,r={},i={};for(n in null!==t&&"object"==typeof t||(t={}),null!==e&&"object"==typeof e||(e={}),e)n in t?r[n]=en(t[n],e[n]):i[n]=e[n];return function(t){for(n in r)i[n]=r[n](t);return i}}:Je)(t,e)}function nn(t,e){return e-=t=+t,function(n){return Math.round(t+e*n)}}Math.PI,Math.SQRT2;function rn(t){return+t}var on=[0,1];function an(t){return t}function un(t,e){return(e-=t=+t)?function(n){return(n-t)/e}:(n=isNaN(e)?NaN:.5,function(){return n});var n}function ln(t){var e,n=t[0],r=t[t.length-1];return n>r&&(e=n,n=r,r=e),function(t){return Math.max(n,Math.min(r,t))}}function cn(t,e,n){var r=t[0],i=t[1],o=e[0],a=e[1];return i<r?(r=un(i,r),o=n(a,o)):(r=un(r,i),o=n(o,a)),function(t){return o(r(t))}}function sn(t,e,n){var r=Math.min(t.length,e.length)-1,i=new Array(r),o=new Array(r),a=-1;for(t[r]<t[0]&&(t=t.slice().reverse(),e=e.slice().reverse());++a<r;)i[a]=un(t[a],t[a+1]),o[a]=n(e[a],e[a+1]);return function(e){var n=De(t,e,1,r)-1;return o[n](i[n](e))}}function fn(t,e){return e.domain(t.domain()).range(t.range()).interpolate(t.interpolate()).clamp(t.clamp()).unknown(t.unknown())}function hn(t,e){return function(){var t,e,n,r,i,o,a=on,u=on,l=en,c=an;function s(){return r=Math.min(a.length,u.length)>2?sn:cn,i=o=null,f}function f(e){return isNaN(e=+e)?n:(i||(i=r(a.map(t),u,l)))(t(c(e)))}return f.invert=function(n){return c(e((o||(o=r(u,a.map(t),Je)))(n)))},f.domain=function(t){return arguments.length?(a=We.call(t,rn),c===an||(c=ln(a)),s()):a.slice()},f.range=function(t){return arguments.length?(u=Ie.call(t),s()):u.slice()},f.rangeRound=function(t){return u=Ie.call(t),l=nn,s()},f.clamp=function(t){return arguments.length?(c=t?ln(a):an,f):c!==an},f.interpolate=function(t){return arguments.length?(l=t,s()):l},f.unknown=function(t){return arguments.length?(n=t,f):n},function(n,r){return t=n,e=r,s()}}()(t,e)}function gn(t,e){if((n=(t=e?t.toExponential(e-1):t.toExponential()).indexOf("e"))<0)return null;var n,r=t.slice(0,n);return[r.length>1?r[0]+r.slice(2):r,+t.slice(n+1)]}function mn(t){return(t=gn(Math.abs(t)))?t[1]:NaN}var dn,yn=/^(?:(.)?([<>=^]))?([+\-( ])?([$#])?(0)?(\d+)?(,)?(\.\d+)?(~)?([a-z%])?$/i;function pn(t){return new vn(t)}function vn(t){if(!(e=yn.exec(t)))throw new Error("invalid format: "+t);var e;this.fill=e[1]||" ",this.align=e[2]||">",this.sign=e[3]||"-",this.symbol=e[4]||"",this.zero=!!e[5],this.width=e[6]&&+e[6],this.comma=!!e[7],this.precision=e[8]&&+e[8].slice(1),this.trim=!!e[9],this.type=e[10]||""}function xn(t,e){var n=gn(t,e);if(!n)return t+"";var r=n[0],i=n[1];return i<0?"0."+new Array(-i).join("0")+r:r.length>i+1?r.slice(0,i+1)+"."+r.slice(i+1):r+new Array(i-r.length+2).join("0")}pn.prototype=vn.prototype,vn.prototype.toString=function(){return this.fill+this.align+this.sign+this.symbol+(this.zero?"0":"")+(null==this.width?"":Math.max(1,0|this.width))+(this.comma?",":"")+(null==this.precision?"":"."+Math.max(0,0|this.precision))+(this.trim?"~":"")+this.type};var bn={"%":function(t,e){return(100*t).toFixed(e)},b:function(t){return Math.round(t).toString(2)},c:function(t){return t+""},d:function(t){return Math.round(t).toString(10)},e:function(t,e){return t.toExponential(e)},f:function(t,e){return t.toFixed(e)},g:function(t,e){return t.toPrecision(e)},o:function(t){return Math.round(t).toString(8)},p:function(t,e){return xn(100*t,e)},r:xn,s:function(t,e){var n=gn(t,e);if(!n)return t+"";var r=n[0],i=n[1],o=i-(dn=3*Math.max(-8,Math.min(8,Math.floor(i/3))))+1,a=r.length;return o===a?r:o>a?r+new Array(o-a+1).join("0"):o>0?r.slice(0,o)+"."+r.slice(o):"0."+new Array(1-o).join("0")+gn(t,Math.max(0,e+o-1))[0]},X:function(t){return Math.round(t).toString(16).toUpperCase()},x:function(t){return Math.round(t).toString(16)}};function _n(t){return t}var Mn,wn,Cn,Tn=["y","z","a","f","p","n","µ","m","","k","M","G","T","P","E","Z","Y"];function kn(t){var e,n,r=t.grouping&&t.thousands?(e=t.grouping,n=t.thousands,function(t,r){for(var i=t.length,o=[],a=0,u=e[0],l=0;i>0&&u>0&&(l+u+1>r&&(u=Math.max(1,r-l)),o.push(t.substring(i-=u,i+u)),!((l+=u+1)>r));)u=e[a=(a+1)%e.length];return o.reverse().join(n)}):_n,i=t.currency,o=t.decimal,a=t.numerals?function(t){return function(e){return e.replace(/[0-9]/g,function(e){return t[+e]})}}(t.numerals):_n,u=t.percent||"%";function l(t){var e=(t=pn(t)).fill,n=t.align,l=t.sign,c=t.symbol,s=t.zero,f=t.width,h=t.comma,g=t.precision,m=t.trim,d=t.type;"n"===d?(h=!0,d="g"):bn[d]||(null==g&&(g=12),m=!0,d="g"),(s||"0"===e&&"="===n)&&(s=!0,e="0",n="=");var y="$"===c?i[0]:"#"===c&&/[boxX]/.test(d)?"0"+d.toLowerCase():"",p="$"===c?i[1]:/[%p]/.test(d)?u:"",v=bn[d],x=/[defgprs%]/.test(d);function b(t){var i,u,c,b=y,_=p;if("c"===d)_=v(t)+_,t="";else{var M=(t=+t)<0;if(t=v(Math.abs(t),g),m&&(t=function(t){t:for(var e,n=t.length,r=1,i=-1;r<n;++r)switch(t[r]){case".":i=e=r;break;case"0":0===i&&(i=r),e=r;break;default:if(i>0){if(!+t[r])break t;i=0}}return i>0?t.slice(0,i)+t.slice(e+1):t}(t)),M&&0==+t&&(M=!1),b=(M?"("===l?l:"-":"-"===l||"("===l?"":l)+b,_=("s"===d?Tn[8+dn/3]:"")+_+(M&&"("===l?")":""),x)for(i=-1,u=t.length;++i<u;)if(48>(c=t.charCodeAt(i))||c>57){_=(46===c?o+t.slice(i+1):t.slice(i))+_,t=t.slice(0,i);break}}h&&!s&&(t=r(t,1/0));var w=b.length+t.length+_.length,C=w<f?new Array(f-w+1).join(e):"";switch(h&&s&&(t=r(C+t,C.length?f-_.length:1/0),C=""),n){case"<":t=b+t+_+C;break;case"=":t=b+C+t+_;break;case"^":t=C.slice(0,w=C.length>>1)+b+t+_+C.slice(w);break;default:t=C+b+t+_}return a(t)}return g=null==g?6:/[gprs]/.test(d)?Math.max(1,Math.min(21,g)):Math.max(0,Math.min(20,g)),b.toString=function(){return t+""},b}return{format:l,formatPrefix:function(t,e){var n=l(((t=pn(t)).type="f",t)),r=3*Math.max(-8,Math.min(8,Math.floor(mn(e)/3))),i=Math.pow(10,-r),o=Tn[8+r/3];return function(t){return n(i*t)+o}}}}function Sn(t,e,n,r){var i,o=Ue(t,e,n);switch((r=pn(null==r?",f":r)).type){case"s":var a=Math.max(Math.abs(t),Math.abs(e));return null!=r.precision||isNaN(i=function(t,e){return Math.max(0,3*Math.max(-8,Math.min(8,Math.floor(mn(e)/3)))-mn(Math.abs(t)))}(o,a))||(r.precision=i),Cn(r,a);case"":case"e":case"g":case"p":case"r":null!=r.precision||isNaN(i=function(t,e){return t=Math.abs(t),e=Math.abs(e)-t,Math.max(0,mn(e)-mn(t))+1}(o,Math.max(Math.abs(t),Math.abs(e))))||(r.precision=i-("e"===r.type));break;case"f":case"%":null!=r.precision||isNaN(i=function(t){return Math.max(0,-mn(Math.abs(t)))}(o))||(r.precision=i-2*("%"===r.type))}return wn(r)}function Nn(t){var e=t.domain;return t.ticks=function(t){var n=e();return function(t,e,n){var r,i,o,a,u=-1;if(n=+n,(t=+t)==(e=+e)&&n>0)return[t];if((r=e<t)&&(i=t,t=e,e=i),0===(a=ze(t,e,n))||!isFinite(a))return[];if(a>0)for(t=Math.ceil(t/a),e=Math.floor(e/a),o=new Array(i=Math.ceil(e-t+1));++u<i;)o[u]=(t+u)*a;else for(t=Math.floor(t*a),e=Math.ceil(e*a),o=new Array(i=Math.ceil(t-e+1));++u<i;)o[u]=(t-u)/a;return r&&o.reverse(),o}(n[0],n[n.length-1],null==t?10:t)},t.tickFormat=function(t,n){var r=e();return Sn(r[0],r[r.length-1],null==t?10:t,n)},t.nice=function(n){null==n&&(n=10);var r,i=e(),o=0,a=i.length-1,u=i[o],l=i[a];return l<u&&(r=u,u=l,l=r,r=o,o=a,a=r),(r=ze(u,l,n))>0?r=ze(u=Math.floor(u/r)*r,l=Math.ceil(l/r)*r,n):r<0&&(r=ze(u=Math.ceil(u*r)/r,l=Math.floor(l*r)/r,n)),r>0?(i[o]=Math.floor(u/r)*r,i[a]=Math.ceil(l/r)*r,e(i)):r<0&&(i[o]=Math.ceil(u*r)/r,i[a]=Math.floor(l*r)/r,e(i)),t},t}Mn=kn({decimal:".",thousands:",",grouping:[3],currency:["$",""]}),wn=Mn.format,Cn=Mn.formatPrefix;var Fn=new Date,Dn=new Date;function En(t,e,n,r){function i(e){return t(e=new Date(+e)),e}return i.floor=i,i.ceil=function(n){return t(n=new Date(n-1)),e(n,1),t(n),n},i.round=function(t){var e=i(t),n=i.ceil(t);return t-e<n-t?e:n},i.offset=function(t,n){return e(t=new Date(+t),null==n?1:Math.floor(n)),t},i.range=function(n,r,o){var a,u=[];if(n=i.ceil(n),o=null==o?1:Math.floor(o),!(n<r&&o>0))return u;do{u.push(a=new Date(+n)),e(n,o),t(n)}while(a<n&&n<r);return u},i.filter=function(n){return En(function(e){if(e>=e)for(;t(e),!n(e);)e.setTime(e-1)},function(t,r){if(t>=t)if(r<0)for(;++r<=0;)for(;e(t,-1),!n(t););else for(;--r>=0;)for(;e(t,1),!n(t););})},n&&(i.count=function(e,r){return Fn.setTime(+e),Dn.setTime(+r),t(Fn),t(Dn),Math.floor(n(Fn,Dn))},i.every=function(t){return t=Math.floor(t),isFinite(t)&&t>0?t>1?i.filter(r?function(e){return r(e)%t==0}:function(e){return i.count(0,e)%t==0}):i:null}),i}var An=En(function(){},function(t,e){t.setTime(+t+e)},function(t,e){return e-t});An.every=function(t){return t=Math.floor(t),isFinite(t)&&t>0?t>1?En(function(e){e.setTime(Math.floor(e/t)*t)},function(e,n){e.setTime(+e+n*t)},function(e,n){return(n-e)/t}):An:null};var Ln=6e4,zn=6048e5,Un=En(function(t){t.setTime(t-t.getMilliseconds())},function(t,e){t.setTime(+t+1e3*e)},function(t,e){return(e-t)/1e3},function(t){return t.getUTCSeconds()}),Pn=(En(function(t){t.setTime(t-t.getMilliseconds()-1e3*t.getSeconds())},function(t,e){t.setTime(+t+e*Ln)},function(t,e){return(e-t)/Ln},function(t){return t.getMinutes()}),En(function(t){t.setTime(t-t.getMilliseconds()-1e3*t.getSeconds()-t.getMinutes()*Ln)},function(t,e){t.setTime(+t+36e5*e)},function(t,e){return(e-t)/36e5},function(t){return t.getHours()}),En(function(t){t.setHours(0,0,0,0)},function(t,e){t.setDate(t.getDate()+e)},function(t,e){return(e-t-(e.getTimezoneOffset()-t.getTimezoneOffset())*Ln)/864e5},function(t){return t.getDate()-1}));function Rn(t){return En(function(e){e.setDate(e.getDate()-(e.getDay()+7-t)%7),e.setHours(0,0,0,0)},function(t,e){t.setDate(t.getDate()+7*e)},function(t,e){return(e-t-(e.getTimezoneOffset()-t.getTimezoneOffset())*Ln)/zn})}var On=Rn(0),jn=Rn(1),Yn=(Rn(2),Rn(3),Rn(4)),Hn=(Rn(5),Rn(6),En(function(t){t.setDate(1),t.setHours(0,0,0,0)},function(t,e){t.setMonth(t.getMonth()+e)},function(t,e){return e.getMonth()-t.getMonth()+12*(e.getFullYear()-t.getFullYear())},function(t){return t.getMonth()}),En(function(t){t.setMonth(0,1),t.setHours(0,0,0,0)},function(t,e){t.setFullYear(t.getFullYear()+e)},function(t,e){return e.getFullYear()-t.getFullYear()},function(t){return t.getFullYear()}));Hn.every=function(t){return isFinite(t=Math.floor(t))&&t>0?En(function(e){e.setFullYear(Math.floor(e.getFullYear()/t)*t),e.setMonth(0,1),e.setHours(0,0,0,0)},function(e,n){e.setFullYear(e.getFullYear()+n*t)}):null};var Wn=En(function(t){t.setUTCSeconds(0,0)},function(t,e){t.setTime(+t+e*Ln)},function(t,e){return(e-t)/Ln},function(t){return t.getUTCMinutes()}),In=En(function(t){t.setUTCMinutes(0,0,0)},function(t,e){t.setTime(+t+36e5*e)},function(t,e){return(e-t)/36e5},function(t){return t.getUTCHours()}),Bn=En(function(t){t.setUTCHours(0,0,0,0)},function(t,e){t.setUTCDate(t.getUTCDate()+e)},function(t,e){return(e-t)/864e5},function(t){return t.getUTCDate()-1});function Xn(t){return En(function(e){e.setUTCDate(e.getUTCDate()-(e.getUTCDay()+7-t)%7),e.setUTCHours(0,0,0,0)},function(t,e){t.setUTCDate(t.getUTCDate()+7*e)},function(t,e){return(e-t)/zn})}var qn=Xn(0),$n=Xn(1),Zn=(Xn(2),Xn(3),Xn(4)),Kn=(Xn(5),Xn(6),En(function(t){t.setUTCDate(1),t.setUTCHours(0,0,0,0)},function(t,e){t.setUTCMonth(t.getUTCMonth()+e)},function(t,e){return e.getUTCMonth()-t.getUTCMonth()+12*(e.getUTCFullYear()-t.getUTCFullYear())},function(t){return t.getUTCMonth()})),Vn=En(function(t){t.setUTCMonth(0,1),t.setUTCHours(0,0,0,0)},function(t,e){t.setUTCFullYear(t.getUTCFullYear()+e)},function(t,e){return e.getUTCFullYear()-t.getUTCFullYear()},function(t){return t.getUTCFullYear()});function Qn(t){if(0<=t.y&&t.y<100){var e=new Date(-1,t.m,t.d,t.H,t.M,t.S,t.L);return e.setFullYear(t.y),e}return new Date(t.y,t.m,t.d,t.H,t.M,t.S,t.L)}function Jn(t){if(0<=t.y&&t.y<100){var e=new Date(Date.UTC(-1,t.m,t.d,t.H,t.M,t.S,t.L));return e.setUTCFullYear(t.y),e}return new Date(Date.UTC(t.y,t.m,t.d,t.H,t.M,t.S,t.L))}function Gn(t){return{y:t,m:0,d:1,H:0,M:0,S:0,L:0}}Vn.every=function(t){return isFinite(t=Math.floor(t))&&t>0?En(function(e){e.setUTCFullYear(Math.floor(e.getUTCFullYear()/t)*t),e.setUTCMonth(0,1),e.setUTCHours(0,0,0,0)},function(e,n){e.setUTCFullYear(e.getUTCFullYear()+n*t)}):null};var tr,er,nr,rr={"-":"",_:" ",0:"0"},ir=/^\s*\d+/,or=/^%/,ar=/[\\^$*+?|[\]().{}]/g;function ur(t,e,n){var r=t<0?"-":"",i=(r?-t:t)+"",o=i.length;return r+(o<n?new Array(n-o+1).join(e)+i:i)}function lr(t){return t.replace(ar,"\\$&")}function cr(t){return new RegExp("^(?:"+t.map(lr).join("|")+")","i")}function sr(t){for(var e={},n=-1,r=t.length;++n<r;)e[t[n].toLowerCase()]=n;return e}function fr(t,e,n){var r=ir.exec(e.slice(n,n+1));return r?(t.w=+r[0],n+r[0].length):-1}function hr(t,e,n){var r=ir.exec(e.slice(n,n+1));return r?(t.u=+r[0],n+r[0].length):-1}function gr(t,e,n){var r=ir.exec(e.slice(n,n+2));return r?(t.U=+r[0],n+r[0].length):-1}function mr(t,e,n){var r=ir.exec(e.slice(n,n+2));return r?(t.V=+r[0],n+r[0].length):-1}function dr(t,e,n){var r=ir.exec(e.slice(n,n+2));return r?(t.W=+r[0],n+r[0].length):-1}function yr(t,e,n){var r=ir.exec(e.slice(n,n+4));return r?(t.y=+r[0],n+r[0].length):-1}function pr(t,e,n){var r=ir.exec(e.slice(n,n+2));return r?(t.y=+r[0]+(+r[0]>68?1900:2e3),n+r[0].length):-1}function vr(t,e,n){var r=/^(Z)|([+-]\d\d)(?::?(\d\d))?/.exec(e.slice(n,n+6));return r?(t.Z=r[1]?0:-(r[2]+(r[3]||"00")),n+r[0].length):-1}function xr(t,e,n){var r=ir.exec(e.slice(n,n+2));return r?(t.m=r[0]-1,n+r[0].length):-1}function br(t,e,n){var r=ir.exec(e.slice(n,n+2));return r?(t.d=+r[0],n+r[0].length):-1}function _r(t,e,n){var r=ir.exec(e.slice(n,n+3));return r?(t.m=0,t.d=+r[0],n+r[0].length):-1}function Mr(t,e,n){var r=ir.exec(e.slice(n,n+2));return r?(t.H=+r[0],n+r[0].length):-1}function wr(t,e,n){var r=ir.exec(e.slice(n,n+2));return r?(t.M=+r[0],n+r[0].length):-1}function Cr(t,e,n){var r=ir.exec(e.slice(n,n+2));return r?(t.S=+r[0],n+r[0].length):-1}function Tr(t,e,n){var r=ir.exec(e.slice(n,n+3));return r?(t.L=+r[0],n+r[0].length):-1}function kr(t,e,n){var r=ir.exec(e.slice(n,n+6));return r?(t.L=Math.floor(r[0]/1e3),n+r[0].length):-1}function Sr(t,e,n){var r=or.exec(e.slice(n,n+1));return r?n+r[0].length:-1}function Nr(t,e,n){var r=ir.exec(e.slice(n));return r?(t.Q=+r[0],n+r[0].length):-1}function Fr(t,e,n){var r=ir.exec(e.slice(n));return r?(t.Q=1e3*+r[0],n+r[0].length):-1}function Dr(t,e){return ur(t.getDate(),e,2)}function Er(t,e){return ur(t.getHours(),e,2)}function Ar(t,e){return ur(t.getHours()%12||12,e,2)}function Lr(t,e){return ur(1+Pn.count(Hn(t),t),e,3)}function zr(t,e){return ur(t.getMilliseconds(),e,3)}function Ur(t,e){return zr(t,e)+"000"}function Pr(t,e){return ur(t.getMonth()+1,e,2)}function Rr(t,e){return ur(t.getMinutes(),e,2)}function Or(t,e){return ur(t.getSeconds(),e,2)}function jr(t){var e=t.getDay();return 0===e?7:e}function Yr(t,e){return ur(On.count(Hn(t),t),e,2)}function Hr(t,e){var n=t.getDay();return t=n>=4||0===n?Yn(t):Yn.ceil(t),ur(Yn.count(Hn(t),t)+(4===Hn(t).getDay()),e,2)}function Wr(t){return t.getDay()}function Ir(t,e){return ur(jn.count(Hn(t),t),e,2)}function Br(t,e){return ur(t.getFullYear()%100,e,2)}function Xr(t,e){return ur(t.getFullYear()%1e4,e,4)}function qr(t){var e=t.getTimezoneOffset();return(e>0?"-":(e*=-1,"+"))+ur(e/60|0,"0",2)+ur(e%60,"0",2)}function $r(t,e){return ur(t.getUTCDate(),e,2)}function Zr(t,e){return ur(t.getUTCHours(),e,2)}function Kr(t,e){return ur(t.getUTCHours()%12||12,e,2)}function Vr(t,e){return ur(1+Bn.count(Vn(t),t),e,3)}function Qr(t,e){return ur(t.getUTCMilliseconds(),e,3)}function Jr(t,e){return Qr(t,e)+"000"}function Gr(t,e){return ur(t.getUTCMonth()+1,e,2)}function ti(t,e){return ur(t.getUTCMinutes(),e,2)}function ei(t,e){return ur(t.getUTCSeconds(),e,2)}function ni(t){var e=t.getUTCDay();return 0===e?7:e}function ri(t,e){return ur(qn.count(Vn(t),t),e,2)}function ii(t,e){var n=t.getUTCDay();return t=n>=4||0===n?Zn(t):Zn.ceil(t),ur(Zn.count(Vn(t),t)+(4===Vn(t).getUTCDay()),e,2)}function oi(t){return t.getUTCDay()}function ai(t,e){return ur($n.count(Vn(t),t),e,2)}function ui(t,e){return ur(t.getUTCFullYear()%100,e,2)}function li(t,e){return ur(t.getUTCFullYear()%1e4,e,4)}function ci(){return"+0000"}function si(){return"%"}function fi(t){return+t}function hi(t){return Math.floor(+t/1e3)}!function(t){tr=function(t){var e=t.dateTime,n=t.date,r=t.time,i=t.periods,o=t.days,a=t.shortDays,u=t.months,l=t.shortMonths,c=cr(i),s=sr(i),f=cr(o),h=sr(o),g=cr(a),m=sr(a),d=cr(u),y=sr(u),p=cr(l),v=sr(l),x={a:function(t){return a[t.getDay()]},A:function(t){return o[t.getDay()]},b:function(t){return l[t.getMonth()]},B:function(t){return u[t.getMonth()]},c:null,d:Dr,e:Dr,f:Ur,H:Er,I:Ar,j:Lr,L:zr,m:Pr,M:Rr,p:function(t){return i[+(t.getHours()>=12)]},Q:fi,s:hi,S:Or,u:jr,U:Yr,V:Hr,w:Wr,W:Ir,x:null,X:null,y:Br,Y:Xr,Z:qr,"%":si},b={a:function(t){return a[t.getUTCDay()]},A:function(t){return o[t.getUTCDay()]},b:function(t){return l[t.getUTCMonth()]},B:function(t){return u[t.getUTCMonth()]},c:null,d:$r,e:$r,f:Jr,H:Zr,I:Kr,j:Vr,L:Qr,m:Gr,M:ti,p:function(t){return i[+(t.getUTCHours()>=12)]},Q:fi,s:hi,S:ei,u:ni,U:ri,V:ii,w:oi,W:ai,x:null,X:null,y:ui,Y:li,Z:ci,"%":si},_={a:function(t,e,n){var r=g.exec(e.slice(n));return r?(t.w=m[r[0].toLowerCase()],n+r[0].length):-1},A:function(t,e,n){var r=f.exec(e.slice(n));return r?(t.w=h[r[0].toLowerCase()],n+r[0].length):-1},b:function(t,e,n){var r=p.exec(e.slice(n));return r?(t.m=v[r[0].toLowerCase()],n+r[0].length):-1},B:function(t,e,n){var r=d.exec(e.slice(n));return r?(t.m=y[r[0].toLowerCase()],n+r[0].length):-1},c:function(t,n,r){return C(t,e,n,r)},d:br,e:br,f:kr,H:Mr,I:Mr,j:_r,L:Tr,m:xr,M:wr,p:function(t,e,n){var r=c.exec(e.slice(n));return r?(t.p=s[r[0].toLowerCase()],n+r[0].length):-1},Q:Nr,s:Fr,S:Cr,u:hr,U:gr,V:mr,w:fr,W:dr,x:function(t,e,r){return C(t,n,e,r)},X:function(t,e,n){return C(t,r,e,n)},y:pr,Y:yr,Z:vr,"%":Sr};function M(t,e){return function(n){var r,i,o,a=[],u=-1,l=0,c=t.length;for(n instanceof Date||(n=new Date(+n));++u<c;)37===t.charCodeAt(u)&&(a.push(t.slice(l,u)),null!=(i=rr[r=t.charAt(++u)])?r=t.charAt(++u):i="e"===r?" ":"0",(o=e[r])&&(r=o(n,i)),a.push(r),l=u+1);return a.push(t.slice(l,u)),a.join("")}}function w(t,e){return function(n){var r,i,o=Gn(1900);if(C(o,t,n+="",0)!=n.length)return null;if("Q"in o)return new Date(o.Q);if("p"in o&&(o.H=o.H%12+12*o.p),"V"in o){if(o.V<1||o.V>53)return null;"w"in o||(o.w=1),"Z"in o?(i=(r=Jn(Gn(o.y))).getUTCDay(),r=i>4||0===i?$n.ceil(r):$n(r),r=Bn.offset(r,7*(o.V-1)),o.y=r.getUTCFullYear(),o.m=r.getUTCMonth(),o.d=r.getUTCDate()+(o.w+6)%7):(i=(r=e(Gn(o.y))).getDay(),r=i>4||0===i?jn.ceil(r):jn(r),r=Pn.offset(r,7*(o.V-1)),o.y=r.getFullYear(),o.m=r.getMonth(),o.d=r.getDate()+(o.w+6)%7)}else("W"in o||"U"in o)&&("w"in o||(o.w="u"in o?o.u%7:"W"in o?1:0),i="Z"in o?Jn(Gn(o.y)).getUTCDay():e(Gn(o.y)).getDay(),o.m=0,o.d="W"in o?(o.w+6)%7+7*o.W-(i+5)%7:o.w+7*o.U-(i+6)%7);return"Z"in o?(o.H+=o.Z/100|0,o.M+=o.Z%100,Jn(o)):e(o)}}function C(t,e,n,r){for(var i,o,a=0,u=e.length,l=n.length;a<u;){if(r>=l)return-1;if(37===(i=e.charCodeAt(a++))){if(i=e.charAt(a++),!(o=_[i in rr?e.charAt(a++):i])||(r=o(t,n,r))<0)return-1}else if(i!=n.charCodeAt(r++))return-1}return r}return x.x=M(n,x),x.X=M(r,x),x.c=M(e,x),b.x=M(n,b),b.X=M(r,b),b.c=M(e,b),{format:function(t){var e=M(t+="",x);return e.toString=function(){return t},e},parse:function(t){var e=w(t+="",Qn);return e.toString=function(){return t},e},utcFormat:function(t){var e=M(t+="",b);return e.toString=function(){return t},e},utcParse:function(t){var e=w(t,Jn);return e.toString=function(){return t},e}}}(t),tr.format,tr.parse,er=tr.utcFormat,nr=tr.utcParse}({dateTime:"%x, %X",date:"%-m/%-d/%Y",time:"%-I:%M:%S %p",periods:["AM","PM"],days:["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"],shortDays:["Sun","Mon","Tue","Wed","Thu","Fri","Sat"],months:["January","February","March","April","May","June","July","August","September","October","November","December"],shortMonths:["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"]});Date.prototype.toISOString||er("%Y-%m-%dT%H:%M:%S.%LZ");+new Date("2000-01-01T00:00:00.000Z")||nr("%Y-%m-%dT%H:%M:%S.%LZ");var gi=1e3,mi=60*gi,di=60*mi,yi=24*di,pi=7*yi,vi=30*yi,xi=365*yi;function bi(t){return new Date(t)}function _i(t){return t instanceof Date?+t:+new Date(+t)}function Mi(){return Pe.apply(function t(e,n,r,i,o,a,u,l,c){var s=hn(an,an),f=s.invert,h=s.domain,g=c(".%L"),m=c(":%S"),d=c("%I:%M"),y=c("%I %p"),p=c("%a %d"),v=c("%b %d"),x=c("%B"),b=c("%Y"),_=[[u,1,gi],[u,5,5*gi],[u,15,15*gi],[u,30,30*gi],[a,1,mi],[a,5,5*mi],[a,15,15*mi],[a,30,30*mi],[o,1,di],[o,3,3*di],[o,6,6*di],[o,12,12*di],[i,1,yi],[i,2,2*yi],[r,1,pi],[n,1,vi],[n,3,3*vi],[e,1,xi]];function M(t){return(u(t)<t?g:a(t)<t?m:o(t)<t?d:i(t)<t?y:n(t)<t?r(t)<t?p:v:e(t)<t?x:b)(t)}function w(t,n,r,i){if(null==t&&(t=10),"number"==typeof t){var o=Math.abs(r-n)/t,a=Fe(function(t){return t[2]}).right(_,o);a===_.length?(i=Ue(n/xi,r/xi,t),t=e):a?(i=(a=_[o/_[a-1][2]<_[a][2]/o?a-1:a])[1],t=a[0]):(i=Math.max(Ue(n,r,t),1),t=l)}return null==i?t:t.every(i)}return s.invert=function(t){return new Date(f(t))},s.domain=function(t){return arguments.length?h(We.call(t,_i)):h().map(bi)},s.ticks=function(t,e){var n,r=h(),i=r[0],o=r[r.length-1],a=o<i;return a&&(n=i,i=o,o=n),n=(n=w(t,i,o,e))?n.range(i,o+1):[],a?n.reverse():n},s.tickFormat=function(t,e){return null==e?M:c(e)},s.nice=function(t,e){var n=h();return(t=w(t,n[0],n[n.length-1],e))?h(function(t,e){var n,r=0,i=(t=t.slice()).length-1,o=t[r],a=t[i];return a<o&&(n=r,r=i,i=n,n=o,o=a,a=n),t[r]=e.floor(o),t[i]=e.ceil(a),t}(n,t)):s},s.copy=function(){return fn(s,t(e,n,r,i,o,a,u,l,c))},s}(Vn,Kn,qn,Bn,In,Wn,Un,An,er).domain([Date.UTC(2e3,0,1),Date.UTC(2e3,0,2)]),arguments)}function wi(){var t=Nn(function(){var t,e,n,r,i,o=0,a=1,u=an,l=!1;function c(e){return isNaN(e=+e)?i:u(0===n?.5:(e=(r(e)-t)*n,l?Math.max(0,Math.min(1,e)):e))}return c.domain=function(i){return arguments.length?(t=r(o=+i[0]),e=r(a=+i[1]),n=t===e?0:1/(e-t),c):[o,a]},c.clamp=function(t){return arguments.length?(l=!!t,c):l},c.interpolator=function(t){return arguments.length?(u=t,c):u},c.unknown=function(t){return arguments.length?(i=t,c):i},function(i){return r=i,t=i(o),e=i(a),n=t===e?0:1/(e-t),c}}()(an));return t.copy=function(){return e=t,wi().domain(e.domain()).interpolator(e.interpolator()).clamp(e.clamp()).unknown(e.unknown());var e},function(t,e){switch(arguments.length){case 0:break;case 1:this.interpolator(t);break;default:this.interpolator(e).domain(t)}return this}.apply(t,arguments)}var Ci=function(t,e){var n=t.getColumn(G,"string"),r=Array.from(new Set(n));return Ti(r,e)},Ti=function(t,e){var n=[];if(t.length<=e.length)n=e.slice(0,t.length);else{var r=Qe(e);n=X(t.length).map(function(e){return r(e/(t.length-1))})}return Xe().domain(t).range(n)},ki=function(t){return a(t).sort().join(" ")},Si=function(t,e,n){for(var i=e.reduce(function(e,n){var i;return r({},e,((i={})[n]=t.getColumn(n),i))},{}),o=[],a=function(t){o.push(ki(e.map(function(e){return i[e][t]})))},u=0;u<t.length;u++)a(u);return t.addColumn(n,"string",o)},Ni=function(t,e){return Si(t,e,G)},Fi=function(t){return{x:t.x,y:t.y,fill:t.fill}},Di=function(t,e){return{fill:Ci(t,e)}},Ei=function(t){var e=t.getColumn("__symbol","string"),n=Array.from(new Set(e));return Xe().domain(n).range(["circle","plus","triangle","square","tritip","ex"])},Ai=function(t,e,n){var r=Si(t,e,G);return Si(r,n,"__symbol")},Li=function(t){return{x:t.x,y:t.y,fill:t.fill,symbol:t.symbol}},zi=function(t,e){return{fill:Ci(t,e),symbol:Ei(t)}},Ui=function(){function t(t){this.length=0,this.columns={},this.length=t}return Object.defineProperty(t.prototype,"columnKeys",{get:function(){return Object.keys(this.columns)},enumerable:!0,configurable:!0}),t.prototype.getColumn=function(t,e){var n=this.columns[t];if(!n)throw new Error("column not found");var r="number"===e&&"time"===n.type;if(e&&e!==n.type&&!r)throw new Error("expected "+e+" column, found "+n.type+" column instead");switch(e){case"number":case"time":case"string":case"boolean":default:return n.data}},t.prototype.getColumnName=function(t){var e=this.columns[t];if(!e)throw new Error("column not found");return e.name},t.prototype.getColumnType=function(t){var e=this.columns[t];if(!e)throw new Error("column not found");return e.type},t.prototype.addColumn=function(e,n,i,o){var a;if(this.columns[e])throw new Error("column already exists");if(i.length!==this.length)throw new Error("expected column of length "+this.length+", got column of length "+i.length+" instead");var u=new t(this.length);return u.columns=r({},this.columns,((a={})[e]={name:o||e,type:n,data:i},a)),u},t}(),Pi=function(t){return new Ui(t)},Ri=function(t,e,n,r,i,o,a,u){return Yi(t,e,n,r,i,o,a,u)},Oi=function(t,e){var n=B(t.getColumn("count","number"));return{fill:wi(Qe(e)).domain(n)}},ji=function(){return{xMin:"xMin",xMax:"xMax",yMin:"yMin",yMax:"yMax",fill:"count"}},Yi=function(t,e,n,r,i,o,a,u){var l=t.getColumn(e,"number"),c=t.getColumn(n,"number"),s=t.getColumnType(e),f=t.getColumnType(n);r||(r=B(l)),i||(i=B(c));for(var h=Math.floor(o/u),g=Math.floor(a/u),m=X(h).map(function(t){return new Array(g).fill(0)}),d=0;d<t.length;d++){var y=l[d],p=c[d];if(!(!y||!p||y<r[0]||y>r[1]||p<i[0]||p>i[1])){var v=Hi(y,r,h),x=Hi(p,i,g);m[v][x]+=1}}var b=(r[1]-r[0])/h,_=(i[1]-i[0])/g,M=[],w=[],C=[],T=[],k=[];for(d=0;d<h;d++)for(var S=0;S<g;S++)M.push(r[0]+d*b),w.push(r[0]+(d+1)*b),C.push(i[0]+S*_),T.push(i[0]+(S+1)*_),k.push(m[d][S]);return Pi(M.length).addColumn("xMin",s,M).addColumn("xMax",s,w).addColumn("yMin",f,C).addColumn("yMax",f,T).addColumn("count","number",k)},Hi=function(t,e,n){var r=e[1]-e[0],i=(t-e[0])/r,o=Math.floor(i*n);return o===n&&(o=n-1),o},Wi=function(t,e,n,r,i,o){return void 0===r&&(r=[]),Si(Xi(t,e,n,r,i,o),r,G)},Ii=function(t){return{xMin:"xMin",xMax:"xMax",yMin:"yMin",yMax:"yMax",fill:t}},Bi=function(t,e){return{fill:Ci(t,e)}},Xi=function(t,e,n,a,u,l){var c,s,f,h;void 0===a&&(a=[]);var g,m=t.getColumn(e,"number"),d=t.getColumnType(e);u||(g=m,u=Math.ceil(Math.log(g.length)/Math.LN2)+1),n=$i(m,n);for(var y=qi(n,u),p={},v=0;v<m.length;v++){var x=m[v];if(!(null==x||isNaN(x)||x<n[0]||x>n[1])){var b=Zi(t,a,v),_=ki(Object.values(b)),M=(x-n[0])/(n[1]-n[0]),w=Math.floor(M*u);w===y.length&&(w=y.length-1);var C=y[w];p[_]=b,C.values[_]?C.values[_]+=1:C.values[_]=1}}var T=Object.keys(p),k=[],S=[],N=[],F=[],D=[],E=a.reduce(function(t,e){var n;return r({},t,((n={})[e]=[],n))},{});for(v=0;v<T.length;v++){_=T[v];var A=function(t){var e,n,r=t.values[_]||0,a=0;"stacked"===l&&(a=T.slice(0,v).reduce(function(e,n){return e+(t.values[n]||0)},0)),k.push(t.min),S.push(t.max),N.push(a),F.push(a+r),D.push(r);try{for(var u=i(Object.entries(p[_])),c=u.next();!c.done;c=u.next()){var s=o(c.value,2),f=s[0],h=s[1];E[f].push(h)}}catch(t){e={error:t}}finally{try{c&&!c.done&&(n=u.return)&&n.call(u)}finally{if(e)throw e.error}}};try{for(var L=i(y),z=L.next();!z.done;z=L.next()){A(z.value)}}catch(t){c={error:t}}finally{try{z&&!z.done&&(s=L.return)&&s.call(L)}finally{if(c)throw c.error}}}var U=Pi(u*T.length).addColumn("xMin",d,k).addColumn("xMax",d,S).addColumn("yMin","number",N).addColumn("yMax","number",F).addColumn("count","number",D);try{for(var P=i(Object.entries(E)),R=P.next();!R.done;R=P.next()){var O=o(R.value,2),j=O[0],Y=O[1],H=t.getColumnType(j),W=t.getColumnName(j);U=U.addColumn(j,H,Y,W)}}catch(t){f={error:t}}finally{try{R&&!R.done&&(h=P.return)&&h.call(P)}finally{if(f)throw f.error}}return U},qi=function(t,e){var n=(t[1]-t[0])/e,r=X(t[0],t[1],n);return r.map(function(e,n){return{min:e,max:n===r.length-1?t[1]:r[n+1],values:{}}})},$i=function(t,e){var n;return(n=e?[e[0],e[1]]:B(t))[0]===n[1]&&(n[1]=n[0]+1),n},Zi=function(t,e,n){var r,o,a={};try{for(var u=i(e),l=u.next();!l.done;l=u.next()){var c=l.value;a[c]=t.getColumn(c)[n]}}catch(t){r={error:t}}finally{try{l&&!l.done&&(o=u.return)&&o.call(u)}finally{if(r)throw r.error}}return a},Ki=function(t){var e=Vi(t);return function(t){return e(new Date(t))}},Vi=function(t){var e=t[1]-t[0];if(e<Ji[0][0])return Ji[0][1];if(e>Ji[Ji.length-1][0])return Ji[Ji.length-1][1];for(var n=0;n<Ji.length-1;n++)if(e>Ji[n][0]&&e<=Ji[n+1][0])return Ji[n+1][1];return function(t){return String(t)}},Qi=function(t,e,n){void 0===e&&(e=2),void 0===n&&(n="0");var r=String(t);return r.length>=e?r:n.repeat(e-r.length)+r},Ji=[[1e3,function(t){return Qi(t.getSeconds())+"."+Qi(t.getMilliseconds(),3)}],[36e5,function(t){return Qi(t.getHours())+":"+Qi(t.getMinutes())+":"+Qi(t.getSeconds())}],[864e5,function(t){return Qi(t.getHours())+":"+Qi(t.getMinutes())}],[2592e6,function(t){return t.getFullYear()+"-"+Qi(t.getMonth()+1)+"-"+Qi(t.getDate())+" "+Qi(t.getHours())+":"+Qi(t.getMinutes())}],[2592e6,function(t){return t.getFullYear()+"-"+Qi(t.getMonth()+1)+"-"+Qi(t.getDate())}]],Gi=function(t,e,n,r,i){var o;o="time"===r?Ki(t)(t[1]):String(t[1]);var a="vertical"===n?i.height:i.width,u=to(o,e,a);return"time"===r?eo(t,e,u):K(t[0],t[1],u)},to=function(t,e,n){var r=t.length*n,i=Math.round(e/r*.5);return Math.max(i,2)},eo=function(t,e,n){var r=o(t,2),i=r[0],a=r[1];return Mi().domain([i,a]).range([0,e]).ticks(n).map(function(t){return t.getTime()})},no=function(t,e){if(!t)throw new Error(e)},ro=function(t,e){var n=document.createElement("div"),r=document.createElement("span");n.appendChild(r),n.setAttribute("style","font: "+t+"; display: inline; position: fixed; transform: translate(-9999px, -9999px);"),document.body.appendChild(n),r.innerText=e;var i={width:r.offsetWidth,height:r.offsetHeight};return document.body.removeChild(n),i},io=function(t,e,n,r,o,a){if(!t)return{top:1,right:1,bottom:1,left:1};var u=function(t,e){var n,r,o=null,a=-1/0;try{for(var u=i(e),l=u.next();!l.done;l=u.next()){var c=l.value,s=t(c);s>a&&(o=c,a=s)}}catch(t){n={error:t}}finally{try{l&&!l.done&&(r=u.return)&&r.call(u)}finally{if(n)throw n.error}}return o}(function(t){return t.length},r.map(function(t){return o(t)})),l=ro(a,u),c=l.width,s=l.height;return{top:s/2,right:1,bottom:s+8+(e?s+15:0),left:c+8+(n?s+15:0)}},oo=function(t,e,n){var r,o;if(void 0===e&&(e=[]),void 0===n&&(n=[]),null==t||"string"==typeof t)return n;try{for(var u=i(Object.keys(t)),l=u.next();!l.done;l=u.next()){var c=l.value,s=a(e,[c]);n.push(s),oo(t[c],s,n)}}catch(t){r={error:t}}finally{try{l&&!l.done&&(o=u.return)&&o.call(u)}finally{if(r)throw r.error}}return n},ao=function(t,e){if(e.length)try{for(var n=0,r=t[e[n]];void 0!==r;){if(n===e.length-1)return r;r=r[e[n+=1]]}}catch(t){}},uo=function(t,e,n){if(!e.length)throw new Error("invalid path");if("object"!=typeof t)throw new Error("target of setByPath must be object");1===e.length&&(t[e[0]]=n);for(var r=-1,i=t;r<e.length-2;){var o=i[e[r+1]];if("object"!=typeof o){var a=isNaN(+e[r+1]);i[e[r+1]]=a?{}:[],o=i[e[r+1]]}r+=1,i=o}i[e[r+1]]=n},lo=function(t,e){if(null==t||null==e)return t===e;switch(typeof e){case"number":case"boolean":case"string":case"function":return t===e;default:var n=Object.keys(t),r=Object.keys(e);return n.length===r.length&&n.every(function(n){return lo(t[n],e[n])})}},co=function(t,e){return t.length===e.length&&t.every(function(t,n){return r=t,i=e[n],r===i;var r,i})};function so(t,e){var n;void 0===e&&(e=co);var r,i=[],o=!1;return function(){for(var a=arguments.length,u=new Array(a),l=0;l<a;l++)u[l]=arguments[l];return o&&n===this&&e(u,i)?r:(r=t.apply(this,u),o=!0,n=this,i=u,r)}}var fo=function(){function t(){this.memoizedFunctions={}}return t.prototype.get=function(t,e){this.memoizedFunctions[t]||(this.memoizedFunctions[t]={memoized:so(e),original:e});var n=this.memoizedFunctions[t],r=n.memoized,i=n.original;if(i!==e)throw new Error("expected "+e+" but found "+i);return r},t}(),ho=wn(".4~f"),go=wn(".4~s"),mo=function(t){return t>=-1&&t<=1?ho(t):go(t)},yo=function(t,e){return function t(){var e=hn(an,an);return e.copy=function(){return fn(e,t())},Pe.apply(e,arguments),Nn(e)}().domain(t).range(e)},po=["x","xMin","xMax"],vo=["y","yMin","yMax"],xo=[0,1],bo=[0,1],_o=function(t){return String(t)},Mo=function(){function t(){var t=this;this._config=null,this._xDomain=null,this._yDomain=null,this.fns=new fo,this.getFormatterForColumn=function(e){var n=t.config.valueFormatters[e];if(n)return n;switch(t.getColumnTypeByKey(e)){case"number":return mo;case"time":return t.timeFormatter;default:return _o}},this.getTable=function(e){var n=t.config.table,r=t.config.layers[e],i=e+" "+r.type+" table";switch(r.type){case"line":var o=r.fill;return t.fns.get(i,Ni)(n,o);case"scatter":o=r.fill;var a=r.symbol;return t.fns.get(i,Ai)(n,o,a);case"histogram":var u=r.x,l=(o=r.fill,r.binCount),c=r.position;return t.fns.get(i,Wi)(n,u,t.config.xDomain,o,l,c);case"heatmap":u=r.x;var s=r.y,f=r.binSize,h=t.config,g=h.width,m=h.height,d=h.xDomain,y=h.yDomain;return t.fns.get(i,Ri)(n,u,s,d,y,g,m,f);default:return t.config.table}},this.getScale=function(e,n){var r=t.config.layers[e],i=r.type,o=r.colors,a=e+" "+i+" scales",u=t.getTable(e);switch(i){case"line":return t.fns.get(a,Di)(u,o)[n];case"scatter":return t.fns.get(a,zi)(u,o)[n];case"histogram":return t.fns.get(a,Bi)(u,o)[n];case"heatmap":return t.fns.get(a,Oi)(u,o)[n];default:throw new Error(n+" scale for layer "+e+" not found")}},this.getMapping=function(e,n){var r=t.config.layers[e];switch(r.type){case"line":return Fi(r)[n];case"scatter":return Li(r)[n];case"heatmap":return ji()[n];case"histogram":return Ii(r.fill)[n];default:return null}},this.resetDomains=function(){t.isXControlled?t.config.onResetXDomain():t._xDomain=t.getXDomain(),t.isYControlled?t.config.onResetYDomain():t._yDomain=t.getYDomain()}}return Object.defineProperty(t.prototype,"config",{get:function(){return this._config},set:function(t){var e=this._config;this._config=wo(t,e),Co(this._config,e)&&(this._xDomain=null,this._yDomain=null)},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"margins",{get:function(){var t=this.yTicks,e=this.config,n=e.xAxisLabel,r=e.yAxisLabel,i=e.tickFont;return this.fns.get("margins",io)(this.config.showAxes,n,r,t,this.yTickFormatter,i)},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"innerWidth",{get:function(){var t=this.config.width,e=this.margins;return t-e.left-e.right},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"innerHeight",{get:function(){var t=this.config.height,e=this.margins;return t-e.top-e.bottom},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"xTicks",{get:function(){return this.fns.get("xTicks",Gi)(this.xDomain,this.config.width,"horizontal",this.getColumnTypeForAesthetics(["x","xMin","xMax"]),this.charMetrics)},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"yTicks",{get:function(){return this.fns.get("yTicks",Gi)(this.yDomain,this.config.height,"vertical",this.getColumnTypeForAesthetics(["y","yMin","yMax"]),this.charMetrics)},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"xScale",{get:function(){var t=this.fns.get("xScale",yo),e=this.xDomain,n=this.rangePadding;return t(e,[n,this.innerWidth-2*n])},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"yScale",{get:function(){var t=this.fns.get("yScale",yo),e=this.yDomain,n=this.rangePadding;return t(e,[this.innerHeight-2*n,n])},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"xDomain",{get:function(){return this.isXControlled?this.config.xDomain:(this._xDomain||(this._xDomain=this.getXDomain()),this._xDomain)},set:function(t){this.isXControlled?this.config.onSetXDomain(t):this._xDomain=t},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"yDomain",{get:function(){return this.isYControlled?this.config.yDomain:(this._yDomain||(this._yDomain=this.getYDomain()),this._yDomain)},set:function(t){this.isYControlled?this.config.onSetYDomain(t):this._yDomain=t},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"xTickFormatter",{get:function(){var t=this.getColumnKeysForAesthetics(po);return this.getFormatterForColumn(t[0])},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"yTickFormatter",{get:function(){var t=this.getColumnKeysForAesthetics(vo);return this.getFormatterForColumn(t[0])},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"charMetrics",{get:function(){return this.fns.get("charMetrics",ro)(this.config.tickFont,"W")},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"isXControlled",{get:function(){return this.config.xDomain&&this.config.onSetXDomain&&this.config.onResetXDomain},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"isYControlled",{get:function(){return this.config.yDomain&&this.config.onSetYDomain&&this.config.onResetYDomain},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"timeFormatter",{get:function(){return this.fns.get("timeFormatter",Ki)(this.xDomain)},enumerable:!0,configurable:!0}),t.prototype.getXDomain=function(){return this.getDomainForAesthetics(po)||xo},t.prototype.getYDomain=function(){return this.getDomainForAesthetics(vo)||bo},t.prototype.getColumnTypeForAesthetics=function(t){var e=this,n=this.config.layers.reduce(function(n,r,i){var o=e.getTable(i);return a(n,t.map(function(t){return e.getMapping(i,t)}).filter(function(t){return!!t}).map(function(t){return o.getColumnType(t)}))},[]);return n.length?(no(n.every(function(t){return t===n[0]}),'found multiple column types for aesthetics "'+t+'"'),n[0]):null},t.prototype.getColumnKeysForAesthetics=function(t){var e=this;return st(function(n,r){return t.reduce(function(t,i){if(n[i])return a(t,[n[i]]);var o=e.getMapping(r,i);return o?a(t,[o]):t},[])},this.config.layers)},t.prototype.getDomainForAesthetics=function(t){var e=this,n=this.config.layers.reduce(function(n,r,i){var o=e.getTable(i);return a(n,t.map(function(t){return e.getMapping(i,t)}).filter(function(t){return!!t}).map(function(t){return o.getColumn(t)}))},[]),r="extentOfExtents "+t.join(", ");return this.fns.get(r,ft).apply(void 0,a(n))},t.prototype.getColumnTypeByKey=function(t){if(this.config.table.columnKeys.includes(t))return this.config.table.getColumnType(t);for(var e=0;e<this.config.layers.length;e++){var n=this.getTable(e);if(n.columnKeys.includes(t))return n.getColumnType(t)}return null},Object.defineProperty(t.prototype,"rangePadding",{get:function(){var t=this.config.layers.filter(function(t){return"line"===t.type}).map(function(t){return t.lineWidth});return Math.max.apply(Math,a([0],t))},enumerable:!0,configurable:!0}),t}(),wo=function(t,e){return r({},function(t,e){var n,r,o={root:t},a={root:e},u=oo(a),l={};try{for(var c=i(u),s=c.next();!s.done;s=c.next()){var f=s.value,h=ao(o,f),g=ao(a,f);lo(h,g)?uo(l,f,h):uo(l,f,g)}}catch(t){n={error:t}}finally{try{s&&!s.done&&(r=c.return)&&r.call(c)}finally{if(n)throw n.error}}return l.root}(e,r({},R,t,{layers:(n=t.layers,n.map(function(t){return O[t.type]?r({},O[t.type],t):t})),table:null})),{table:t.table});var n},Co=function(t,e){return!e||(t.table!==e.table||!!a(po,vo).some(function(n){return t.layers.some(function(t,r){return t[n]!==e.layers[r][n]})}))},To=function(t){var n=e.useRef(null);null===n.current&&(n.current=new Mo,n.current.config=t);var r,i,a,u=o(e.useState(0),2),l=u[0],c=u[1];return r=function(){n.current.config=t,c(l+1)},i=[t],a=e.useRef(!0),e.useEffect(function(){if(!a.current)return r();a.current=!1},i),n.current},ko=function(t){var n=t.config,i=t.children,a=To(n),u=a.margins,l=a.config,c=l.width,s=l.height,f=l.showAxes,h=e.useMemo(function(){return{position:"relative",width:c+"px",height:s+"px",userSelect:"none"}},[c,s]),g=e.useMemo(function(){return{position:"absolute",top:u.top+"px",right:u.right+"px",bottom:u.bottom+"px",left:u.left+"px",cursor:"crosshair"}},[u]),m={position:"absolute",top:0,left:0,right:0,bottom:0},d=e.useReducer(function(t){return t+1},0)[1],y=e.useRef(null),p=o(function(){var t=o(e.useState({x:null,y:null}),2),n=t[0],r=t[1];return[n,e.useMemo(function(){return{onMouseEnter:function(t){r(tt(t))},onMouseMove:function(t){r(tt(t))},onMouseLeave:function(){r({x:null,y:null})}}},[])]}(),2),v=p[0],x=p[1],b=function(t){var n=e.useRef(!1),i=e.useRef(!1),a=o(e.useReducer(function(e,n){var i=n.type,o=n.e,a=t.getBoundingClientRect(),u=a.left,l=a.top,c=o.pageX-u,s=o.pageY-l;switch(i){case"mousedown":return{type:"drag",initialX:c,initialY:s,x:c,y:s,dragMode:null,shiftKey:o.shiftKey,metaKey:o.metaKey,ctrlKey:o.ctrlKey};case"mousemove":var f=e.dragMode;if(!f){var h=Math.abs(c-e.initialX),g=Math.abs(s-e.initialY);h>=g&&h>5?f="brushX":g>5&&(f="brushY")}return r({},e,{type:"drag",dragMode:f,x:c,y:s});case"mouseup":return r({},e,{type:"dragend",x:c,y:s});default:return null}},null),2),u=a[0],l=a[1];return e.useEffect(function(){if(t){var e=function(t){l({type:"mousemove",e:t})},r=function(t){document.addEventListener("mousemove",e),n.current=!1,i.current=!0,l({type:"mousedown",e:t})},o=function(t){document.removeEventListener("mousemove",e),n.current=!0,l({type:"mouseup",e:t})};return t.addEventListener("mousedown",r),document.addEventListener("mouseup",o),function(){t.removeEventListener("mousedown",r),document.removeEventListener("mouseup",o),document.removeEventListener("mousemove",e)}}},[t]),i.current?n.current?(i.current=!1,u):u:null}(y.current),_=b?null:v.x,M=b?null:v.y,w=e.useCallback(function(t){a.xDomain=ke(t,a.xScale,a.innerWidth),d()},[a.xScale,a.innerWidth,d]),C=e.useCallback(function(t){a.yDomain=ke(t,a.yScale,a.innerHeight).reverse(),d()},[a.yScale,a.innerHeight,d]),T=e.useCallback(function(){a.resetDomains(),d()},[a]);return e.createElement("div",{className:"vis-plot",style:h},f&&e.createElement(Y,{env:a,style:m}),e.createElement("div",r({className:"vis-inner-plot",style:g,ref:y,onDoubleClick:T},x),e.createElement("div",{className:"vis-layers",style:m},n.layers.map(function(t,n){switch(t.type){case"line":return e.createElement(bt,{key:n,layerIndex:n,env:a,hoverX:_,hoverY:M});case"histogram":return e.createElement(rt,{key:n,layerIndex:n,env:a,hoverX:_,hoverY:M});case"heatmap":return e.createElement(xe,{key:n,layerIndex:n,env:a,hoverX:_,hoverY:M});case"scatter":return e.createElement(Te,{key:n,layerIndex:n,env:a});default:return null}}),i&&i),e.createElement(Se,{event:b,width:a.innerWidth,height:a.innerHeight,onXBrushEnd:w,onYBrushEnd:C})))},So={},No={},Fo=34,Do=10,Eo=13;function Ao(t){return new Function("d","return {"+t.map(function(t,e){return JSON.stringify(t)+": d["+e+"]"}).join(",")+"}")}function Lo(t){var e=Object.create(null),n=[];return t.forEach(function(t){for(var r in t)r in e||n.push(e[r]=r)}),n}function zo(t,e){var n=t+"",r=n.length;return r<e?new Array(e-r+1).join(0)+n:n}function Uo(t){var e,n=t.getUTCHours(),r=t.getUTCMinutes(),i=t.getUTCSeconds(),o=t.getUTCMilliseconds();return isNaN(t)?"Invalid Date":((e=t.getUTCFullYear())<0?"-"+zo(-e,6):e>9999?"+"+zo(e,6):zo(e,4))+"-"+zo(t.getUTCMonth()+1,2)+"-"+zo(t.getUTCDate(),2)+(o?"T"+zo(n,2)+":"+zo(r,2)+":"+zo(i,2)+"."+zo(o,3)+"Z":i?"T"+zo(n,2)+":"+zo(r,2)+":"+zo(i,2)+"Z":r||n?"T"+zo(n,2)+":"+zo(r,2)+"Z":"")}function Po(t){var e=new RegExp('["'+t+"\n\r]"),n=t.charCodeAt(0);function r(t,e){var r,i=[],o=t.length,a=0,u=0,l=o<=0,c=!1;function s(){if(l)return No;if(c)return c=!1,So;var e,r,i=a;if(t.charCodeAt(i)===Fo){for(;a++<o&&t.charCodeAt(a)!==Fo||t.charCodeAt(++a)===Fo;);return(e=a)>=o?l=!0:(r=t.charCodeAt(a++))===Do?c=!0:r===Eo&&(c=!0,t.charCodeAt(a)===Do&&++a),t.slice(i+1,e-1).replace(/""/g,'"')}for(;a<o;){if((r=t.charCodeAt(e=a++))===Do)c=!0;else if(r===Eo)c=!0,t.charCodeAt(a)===Do&&++a;else if(r!==n)continue;return t.slice(i,e)}return l=!0,t.slice(i,o)}for(t.charCodeAt(o-1)===Do&&--o,t.charCodeAt(o-1)===Eo&&--o;(r=s())!==No;){for(var f=[];r!==So&&r!==No;)f.push(r),r=s();e&&null==(f=e(f,u++))||i.push(f)}return i}function i(e,n){return e.map(function(e){return n.map(function(t){return a(e[t])}).join(t)})}function o(e){return e.map(a).join(t)}function a(t){return null==t?"":t instanceof Date?Uo(t):e.test(t+="")?'"'+t.replace(/"/g,'""')+'"':t}return{parse:function(t,e){var n,i,o=r(t,function(t,r){if(n)return n(t,r-1);i=t,n=e?function(t,e){var n=Ao(t);return function(r,i){return e(n(r),i,t)}}(t,e):Ao(t)});return o.columns=i||[],o},parseRows:r,format:function(e,n){return null==n&&(n=Lo(e)),[n.map(a).join(t)].concat(i(e,n)).join("\n")},formatBody:function(t,e){return null==e&&(e=Lo(t)),i(t,e).join("\n")},formatRows:function(t){return t.map(o).join("\n")}}}var Ro=Po(","),Oo=Ro.parse,jo=Ro.parseRows,Yo=(Po("\t"),function(t){var e=t.trim();return""===e?[]:e.split(/\n\s*\n/)}),Ho=function(t){var e=t.split("\n").filter(function(t){return t.startsWith("#")}).join("\n").trim();return no(!!e,"could not find annotation lines in Flux response; are `annotations` enabled in the Flux query `dialect` option?"),e},Wo=function(t,e){var n=jo(t),i=n.find(function(t){return"#group"===t[0]}),o=n.find(function(t){return"#datatype"===t[0]}),u=n.find(function(t){return"#default"===t[0]});return no(!!i,"could not find group annotation in Flux response"),no(!!o,"could not find datatype annotation in Flux response"),no(!!u,"could not find default annotation in Flux response"),{groupKey:i.reduce(function(t,n,r){return"true"===n?a(t,[e[r]]):t},[]),datatypeByColumnName:o.slice(1).reduce(function(t,n,i){var o;return r({},t,((o={})[e[i+1]]=n,o))},{}),defaultByColumnName:u.slice(1).reduce(function(t,n,i){var o;return r({},t,((o={})[e[i+1]]=n,o))},{})}},Io=function(t){return t.split("\n").filter(function(t){return!t.startsWith("#")}).join("\n").trim()},Bo={boolean:"boolean",unsignedLong:"number",long:"number",double:"number",string:"string","dateTime:RFC3339":"time"},Xo=function(t){var e=Bo[t];return no(!!e,"encountered unknown Flux column type "+t),e},qo=function(t,e){if(void 0!==t)return"null"===t?null:"NaN"===t?NaN:"boolean"===e&&"true"===t||("boolean"!==e||"false"!==t)&&("string"===e?t:"time"===e?Date.parse(t):"number"===e?Number(t):null)},$o=function(t,e){var n,a,u=Object.values(t).map(function(t){return t.name}).reduce(function(t,e){var n;return r({},t,((n={})[e]=(t[e]||0)+1,n))},{}),l=Object.entries(u).filter(function(t){var e=o(t,2);e[0];return 1===e[1]}).map(function(t){return o(t,1)[0]}),c=function(n){var r=o(Object.entries(t).find(function(t){var e=o(t,2);e[0];return e[1].name===n}),2),i=r[0],a=r[1];t[n]=a,delete t[i],e.has(i)&&(e.delete(i),e.add(n))};try{for(var s=i(l),f=s.next();!f.done;f=s.next()){c(f.value)}}catch(t){n={error:t}}finally{try{f&&!f.done&&(a=s.return)&&a.call(s)}finally{if(n)throw n.error}}};t.ATLANTIS=["#74D495","#3F3FBA","#FF4D9E"],t.BU_GN=["#f7fcfd","#ebf7fa","#dcf2f2","#c8eae4","#aadfd2","#88d1bc","#68c2a3","#4eb485","#37a266","#228c49","#0d7635","#025f27"],t.CTHULHU=["#FDC44F","#007C76","#8983FF"],t.DELOREAN=["#FD7A5D","#5F1CF2","#4CE09A"],t.DO_ANDROIDS_DREAM=["#8F8AF4","#A51414","#F4CF31"],t.ECTOPLASM=["#DA6FF1","#00717A","#ACFF76"],t.INFERNO=["#000004","#110a30","#320a5e","#57106e","#781c6d","#9a2865","#bc3754","#d84c3e","#ed6925","#f98e09","#fbb61a","#f4df53"],t.MAGMA=["#000004","#100b2d","#2c115f","#51127c","#721f81","#932b80","#b73779","#d8456c","#f1605d","#fc8961","#feb078","#fed799"],t.NINETEEN_EIGHTY_FOUR=U,t.PLASMA=["#0d0887","#3a049a","#5c01a6","#7e03a8","#9c179e","#b52f8c","#cc4778","#de5f65","#ed7953","#f89540","#fdb42f","#fbd524"],t.Plot=function(t){var n=t.config,i=t.children;return n.width&&n.height?e.createElement(ko,{config:n},i):e.createElement(h,{className:"vis-autosizer"},function(t){var o=t.width,a=t.height;return 0===o||0===a?null:e.createElement(ko,{config:r({},n,{width:o,height:a})},i)})},t.T_MAX_400_FILM=["#F6F6F8","#A4A8B6","#545667"],t.VIRIDIS=["#440154","#481f70","#443983","#3b528b","#31688e","#287c8e","#21918c","#20a486","#35b779","#5ec962","#90d743","#c8e020"],t.YL_GN_BU=["#ffffd9","#edf8b1","#c7e9b4","#7fcdbb","#41b6c4","#1d91c0","#225ea8","#253494","#081d58"],t.YL_OR_RD=["#ffffcc","#ffeda0","#fed976","#feb24c","#fd8d3c","#fc4e2a","#e31a1c","#bd0026","#800026"],t.fromFlux=function(t){var e,n,r,a,u={},l=new Set,c=Yo(t),s=0;try{for(var f=i(c),h=f.next();!h.done;h=f.next()){var g=h.value,m=Io(g),d=Oo(m),y=Ho(g),p=Wo(y,d.columns);try{for(var v=i(d.columns.slice(1)),x=v.next();!x.done;x=v.next()){var b=x.value,_=Xo(p.datatypeByColumnName[b]),M=b+" ("+_+")";u[M]||(u[M]={name:b,type:_,data:[]});for(var w=u[M].data,C=p.defaultByColumnName[b],T=0;T<d.length;T++)w[s+T]=qo(d[T][b]||C,_);p.groupKey.includes(b)&&l.add(M)}}catch(t){r={error:t}}finally{try{x&&!x.done&&(a=v.return)&&a.call(v)}finally{if(r)throw r.error}}s+=d.length}}catch(t){e={error:t}}finally{try{h&&!h.done&&(n=f.return)&&n.call(f)}finally{if(e)throw e.error}}return $o(u,l),{table:Object.entries(u).reduce(function(t,e){var n=o(e,2),r=n[0],i=n[1],a=i.name,u=i.type,l=i.data;return l.length=s,t.addColumn(r,u,l,a)},Pi(s)),fluxGroupKeyUnion:Array.from(l)}},t.newTable=Pi,Object.defineProperty(t,"__esModule",{value:!0})});
//# sourceMappingURL=index.js.map
